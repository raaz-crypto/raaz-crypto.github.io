<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Verse.Verse.CryptoLib.sha2.c.portableAnnotated</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Verse.Verse.CryptoLib.sha2.c.portableAnnotated</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Verse.Verse.html#"><span class="id" title="library">Verse</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#"><span class="id" title="library">Verse.CryptoLib.sha2</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Verse.Verse.Semantics.html#"><span class="id" title="library">Verse.Semantics</span></a>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">StandardTactics</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Verse.Verse.WordFacts.html#"><span class="id" title="library">Verse.WordFacts</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Verse.Verse.WordRing.html#"><span class="id" title="library">Verse.WordRing</span></a>.<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">semantic_scope</span>.<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">word_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">NArith</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">Nat</span>.<br/>
<span class="id" title="keyword">Require</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.Vector.html#"><span class="id" title="library">Vector</span></a>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">VectorNotations</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#"><span class="id" title="library">List</span></a>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab99"></a><h1 class="section">SHA2 hashing algorithm.</h1>


<div class="paragraph"> </div>

We give a common iterator for both the sha512 and sha256 algorithm. It
is implemented as a module parameterised over the configuration
module.

<div class="paragraph"> </div>


</div>
<div class="code">
<span class="id" title="keyword">Module</span> <a name="SHA2"><span class="id" title="module">SHA2</span></a> (<span class="id" title="var">C</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#CONFIG"><span class="id" title="module">CONFIG</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">C</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.Word"><span class="id" title="definition">Word</span></a>  := <a class="idref" href="Verse.Verse.Types.Internal.html#word"><span class="id" title="constructor">word</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.WordSize"><span class="id" title="axiom">WordSize</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.Hash"><span class="id" title="definition">Hash</span></a>  := <a class="idref" href="Verse.Verse.Types.html#Array"><span class="id" title="definition">Array</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#HASH_SIZE"><span class="id" title="definition">HASH_SIZE</span></a>  <a class="idref" href="Verse.Verse.Types.Internal.html#hostE"><span class="id" title="constructor">hostE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.Block"><span class="id" title="definition">Block</span></a> := <a class="idref" href="Verse.Verse.Types.html#Array"><span class="id" title="definition">Array</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a> <a class="idref" href="Verse.Verse.Types.Internal.html#bigE"><span class="id" title="constructor">bigE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>.<br/>

<br/>
</div>

<div class="doc">
Some helper inequalities 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">NPeano.Nat.lt_0_succ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.zltBlockSize"><span class="id" title="definition">zltBlockSize</span></a> : 0 <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#989c98e7ddd65d5bf37c334ff2076de8"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.nonZeroBlockSize"><span class="id" title="definition">nonZeroBlockSize</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#32263a1c8b01baecdff9deb038955bc9"><span class="id" title="notation">≠</span></a> 0.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <a name="SHA2.Program"><span class="id" title="section">Program</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="SHA2.Program.v"><span class="id" title="variable">v</span></a> : <a class="idref" href="Verse.Verse.Syntax.html#VariableT"><span class="id" title="definition">VariableT</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">v</span> [<span class="id" title="var">k</span>] <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab100"></a><h2 class="section">Program variables.</h2>


<div class="paragraph"> </div>

        The standard idiom of verse is to declare the parameters,
        local variables, and register variables in that order.

<div class="paragraph"> </div>

     
<div class="paragraph"> </div>

<a name="lab101"></a><h3 class="section">Parameters</h3>


<div class="paragraph"> </div>

        SHA2 hashes are Merkel-Damgrad hash. The block iterator is
        only expected to compress the blocks and issues like padding
        is to be handled separately by the calling function.  Hence
        the iterator only needs the hash of the previous blocks to
        continue processing blocks. Thus there is only one parameter
        for the hash function namely the hash of the previous block.
     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="SHA2.Program.hash"><span class="id" title="variable">hash</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Hash"><span class="id" title="definition">Hash</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.parameters"><span class="id" title="definition">parameters</span></a> : <a class="idref" href="Verse.Verse.Syntax.html#Declaration"><span class="id" title="abbreviation">Declaration</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#b68b81bcad07e24b95d313521ca8d755"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.Syntax.html#Var"><span class="id" title="definition">Var</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.hash"><span class="id" title="variable">hash</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#b68b81bcad07e24b95d313521ca8d755"><span class="id" title="notation">]</span></a>%<span class="id" title="var">vector</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab102"></a><h3 class="section">Local variables.</h3>


<div class="paragraph"> </div>

        We keep the current block in a set of local variables. When
        compiling the resulting C code to a register rich machine, all
        of them could be allocated in registers and thus could be
        faster.

<div class="paragraph"> </div>

     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="SHA2.Program.w0"><span class="id" title="variable">w0</span></a> <a name="SHA2.Program.w1"><span class="id" title="variable">w1</span></a> <a name="SHA2.Program.w2"><span class="id" title="variable">w2</span></a> <a name="SHA2.Program.w3"><span class="id" title="variable">w3</span></a> <a name="SHA2.Program.w4"><span class="id" title="variable">w4</span></a> <a name="SHA2.Program.w5"><span class="id" title="variable">w5</span></a> <a name="SHA2.Program.w6"><span class="id" title="variable">w6</span></a> <a name="SHA2.Program.w7"><span class="id" title="variable">w7</span></a> <a name="SHA2.Program.w8"><span class="id" title="variable">w8</span></a> <a name="SHA2.Program.w9"><span class="id" title="variable">w9</span></a> <a name="SHA2.Program.w10"><span class="id" title="variable">w10</span></a> <a name="SHA2.Program.w11"><span class="id" title="variable">w11</span></a> <a name="SHA2.Program.w12"><span class="id" title="variable">w12</span></a> <a name="SHA2.Program.w13"><span class="id" title="variable">w13</span></a> <a name="SHA2.Program.w14"><span class="id" title="variable">w14</span></a> <a name="SHA2.Program.w15"><span class="id" title="variable">w15</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.message_variables"><span class="id" title="definition">message_variables</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">[</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w0"><span class="id" title="variable">w0</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w1"><span class="id" title="variable">w1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w2"><span class="id" title="variable">w2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w3"><span class="id" title="variable">w3</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w4"><span class="id" title="variable">w4</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w5"><span class="id" title="variable">w5</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w6"><span class="id" title="variable">w6</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w7"><span class="id" title="variable">w7</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w8"><span class="id" title="variable">w8</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w9"><span class="id" title="variable">w9</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w10"><span class="id" title="variable">w10</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w11"><span class="id" title="variable">w11</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w12"><span class="id" title="variable">w12</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w13"><span class="id" title="variable">w13</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w14"><span class="id" title="variable">w14</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w15"><span class="id" title="variable">w15</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">]</span></a>%<span class="id" title="var">vector</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.locals"><span class="id" title="definition">locals</span></a> : <a class="idref" href="Verse.Verse.Syntax.html#Declaration"><span class="id" title="abbreviation">Declaration</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.Vector.html#map"><span class="id" title="definition">Vector.map</span></a> <a class="idref" href="Verse.Verse.Syntax.html#Var"><span class="id" title="definition">Var</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.message_variables"><span class="id" title="definition">message_variables</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.W"><span class="id" title="definition">W</span></a> : <a class="idref" href="Verse.Verse.Language.Utils.html#VarIndex"><span class="id" title="definition">VarIndex</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a> := <a class="idref" href="Verse.Verse.Language.Utils.html#varIndex"><span class="id" title="definition">varIndex</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.message_variables"><span class="id" title="definition">message_variables</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.LOAD_BLOCK"><span class="id" title="definition">LOAD_BLOCK</span></a> (<span class="id" title="var">blk</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Block"><span class="id" title="definition">Block</span></a>) := <a class="idref" href="Verse.Verse.Language.Utils.html#loadCache"><span class="id" title="definition">loadCache</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#blk"><span class="id" title="variable">blk</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.W"><span class="id" title="definition">W</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab103"></a><h1 class="section">Message scheduling</h1>

<div class="paragraph"> </div>

<a name="lab104"></a><h2 class="section">The state and temporary variables.</h2>


<div class="paragraph"> </div>

        We choose to put them in registers as there are the variables
        that are frequently used.

<div class="paragraph"> </div>

     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="SHA2.Program.a"><span class="id" title="variable">a</span></a> <a name="SHA2.Program.b"><span class="id" title="variable">b</span></a> <a name="SHA2.Program.c"><span class="id" title="variable">c</span></a> <a name="SHA2.Program.d"><span class="id" title="variable">d</span></a> <a name="SHA2.Program.e"><span class="id" title="variable">e</span></a> <a name="SHA2.Program.f"><span class="id" title="variable">f</span></a> <a name="SHA2.Program.g"><span class="id" title="variable">g</span></a> <a name="SHA2.Program.h"><span class="id" title="variable">h</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="SHA2.Program.t"><span class="id" title="variable">t</span></a> <a name="SHA2.Program.tp"><span class="id" title="variable">tp</span></a> <a name="SHA2.Program.temp"><span class="id" title="variable">temp</span></a>       : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.state_variables"><span class="id" title="definition">state_variables</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.c"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.d"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.f"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.g"><span class="id" title="variable">g</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.h"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">]</span></a>%<span class="id" title="var">vector</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.registers"><span class="id" title="definition">registers</span></a> : <a class="idref" href="Verse.Verse.Syntax.html#Declaration"><span class="id" title="abbreviation">Declaration</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.Vector.html#map"><span class="id" title="definition">Vector.map</span></a> <a class="idref" href="Verse.Verse.Syntax.html#Var"><span class="id" title="definition">Var</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.Vector.html#append"><span class="id" title="definition">Vector.append</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.state_variables"><span class="id" title="definition">state_variables</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">]</span></a>%<span class="id" title="var">vector</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.STATE"><span class="id" title="definition">STATE</span></a> : <a class="idref" href="Verse.Verse.Language.Utils.html#VarIndex"><span class="id" title="definition">VarIndex</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#HASH_SIZE"><span class="id" title="definition">HASH_SIZE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a> := <a class="idref" href="Verse.Verse.Language.Utils.html#varIndex"><span class="id" title="definition">varIndex</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.state_variables"><span class="id" title="definition">state_variables</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.LOAD_STATE"><span class="id" title="definition">LOAD_STATE</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> := <a class="idref" href="Verse.Verse.Language.Utils.html#loadCache"><span class="id" title="definition">loadCache</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.hash"><span class="id" title="variable">hash</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.STATE"><span class="id" title="definition">STATE</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab105"></a><h1 class="section">Message scheduling.</h1>


<div class="paragraph"> </div>

        The block <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w0"><span class="id" title="variable">w0</span></a>,...,<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.w15"><span class="id" title="variable">w15</span></a></span> is expanded to a message schedule
        <span class="inlinecode"><a class="idref" href="Verse.Verse.Language.Operators.html#OpDenote.VectorAux.m"><span class="id" title="variable">m</span></a>(<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a>)</span> given by the recurrence equation.

<div class="paragraph"> </div>

        <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.Language.Operators.html#OpDenote.VectorAux.m"><span class="id" title="variable">m</span></a>(<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.Language.Operators.html#OpDenote.VectorAux.m"><span class="id" title="variable">m</span></a>(<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a></span> <span class="inlinecode">-</span> <span class="inlinecode">16)</span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.Language.Operators.html#OpDenote.VectorAux.m"><span class="id" title="variable">m</span></a>(<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a></span> <span class="inlinecode">-</span> <span class="inlinecode">7)</span> <span class="inlinecode">+</span> <span class="inlinecode">σ<span class="id" title="var">₀</span></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.Language.Operators.html#OpDenote.VectorAux.m"><span class="id" title="variable">m</span></a>(<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a></span> <span class="inlinecode">-</span> <span class="inlinecode">15)</span> <span class="inlinecode">+</span> <span class="inlinecode">σ<span class="id" title="var">₁</span></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.Language.Operators.html#OpDenote.VectorAux.m"><span class="id" title="variable">m</span></a>(<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a></span> <span class="inlinecode">-</span> <span class="inlinecode">2)</span> <span class="inlinecode"></span>

<div class="paragraph"> </div>

        where the σ₀ and σ₁ functions are of the form.

<div class="paragraph"> </div>

        <span class="inlinecode"></span> <span class="inlinecode">σ(<a class="idref" href="Verse.Verse.Arch.C.html#x"><span class="id" title="variable">x</span></a>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">RotR</span>(<a class="idref" href="Verse.Verse.Arch.C.html#x"><span class="id" title="variable">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r0</span></a>)</span> <span class="inlinecode">⊕</span> <span class="inlinecode"><span class="id" title="var">RotR</span>(<a class="idref" href="Verse.Verse.Arch.C.html#x"><span class="id" title="variable">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r1</span></a>)</span> <span class="inlinecode">⊕</span> <span class="inlinecode"><span class="id" title="var">ShiftR</span>(<a class="idref" href="Verse.Verse.Arch.C.html#x"><span class="id" title="variable">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.Semantics.html#Semantics.Semantics.s"><span class="id" title="variable">s</span></a>)</span>
        
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <a name="SHA2.Program.MessageSchedule"><span class="id" title="section">MessageSchedule</span></a>.<br/>

<br/>
</div>

<div class="doc">
We give the message schedule calculation for the ith message
          index. Since the recurrence relation governing m(r) refers
          only to BLOCK_SIZE many previous values, rather than computing
          the sequence m(r) in separate variables we reuse the <span class="inlinecode"><a class="idref" href="Verse.Verse.Arch.C.html#w"><span class="id" title="variable">w</span></a></span>
          varaibles by placing m(r) in <span class="inlinecode"><a class="idref" href="Verse.Verse.Arch.C.html#w"><span class="id" title="variable">w</span></a>(<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a></span> <span class="inlinecode"><span class="id" title="var">mod</span></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a>)</span> 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="SHA2.Program.MessageSchedule.idx"><span class="id" title="variable">idx</span></a>   : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="SHA2.Program.MessageSchedule.idxPf"><span class="id" title="variable">idxPf</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.MessageSchedule.idx"><span class="id" title="variable">idx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#989c98e7ddd65d5bf37c334ff2076de8"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a>.<br/>

<br/>
</div>

<div class="doc">
Function to increment message index 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.nextIdx"><span class="id" title="definition">nextIdx</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#5b63cb9ed0fed82566685c66e56592e4"><span class="id" title="notation">{</span></a> <span class="id" title="var">sIdx</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#5b63cb9ed0fed82566685c66e56592e4"><span class="id" title="notation">|</span></a> <span class="id" title="var">sIdx</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#989c98e7ddd65d5bf37c334ff2076de8"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#5b63cb9ed0fed82566685c66e56592e4"><span class="id" title="notation">}</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.MessageSchedule.idx"><span class="id" title="variable">idx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Nat.html#97a8d8c92e88d1d68fb55a13a4fcfc6d"><span class="id" title="notation">=?</span></a> 15 <span class="id" title="keyword">then</span> @<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> 0 <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.zltBlockSize"><span class="id" title="definition">zltBlockSize</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">let</span> <span class="id" title="var">sIdx</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.MessageSchedule.idx"><span class="id" title="variable">idx</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#sIdx"><span class="id" title="variable">sIdx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Nat.html#0984ed888197c75c46fdcd2f323d822d"><span class="id" title="notation">mod</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a>)%<span class="id" title="var">nat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Numbers.Natural.Peano.NPeano.html#Nat.mod_upper_bound"><span class="id" title="lemma">NPeano.Nat.mod_upper_bound</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#sIdx"><span class="id" title="variable">sIdx</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.nonZeroBlockSize"><span class="id" title="definition">nonZeroBlockSize</span></a>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.M"><span class="id" title="definition">M</span></a>  := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.W"><span class="id" title="definition">W</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.MessageSchedule.idx"><span class="id" title="variable">idx</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.MessageSchedule.idxPf"><span class="id" title="variable">idxPf</span></a>.<br/>

<br/>
</div>

<div class="doc">
We capture m(idx - j) using this variable 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.MM"><span class="id" title="definition">MM</span></a> (<span class="id" title="var">j</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">verse</span> (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.W"><span class="id" title="definition">W</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Nat.html#0984ed888197c75c46fdcd2f323d822d"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.MessageSchedule.idx"><span class="id" title="variable">idx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> 16 <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <span class="id" title="var">j</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Nat.html#0984ed888197c75c46fdcd2f323d822d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Nat.html#0984ed888197c75c46fdcd2f323d822d"><span class="id" title="notation">mod</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a>) <span class="id" title="var">_</span>)%<span class="id" title="var">nat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
We now give the code for updating the message M with the value
          of the appropriate sigma function.
       
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.sigma"><span class="id" title="definition">sigma</span></a> (<span class="id" title="var">r0</span> <span class="id" title="var">r1</span> <span class="id" title="var">s</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)(<span class="id" title="var">x</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e01e4fa8e4b5deaa3d50a75b833817cc"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e01e4fa8e4b5deaa3d50a75b833817cc"><span class="id" title="notation">&gt;&gt;&gt;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r1"><span class="id" title="variable">r1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e01e4fa8e4b5deaa3d50a75b833817cc"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e01e4fa8e4b5deaa3d50a75b833817cc"><span class="id" title="notation">&gt;&gt;&gt;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r0"><span class="id" title="variable">r0</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#5cb80321c7d7396b2ae1a6d4a6e54c61"><span class="id" title="notation">::=^</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>      <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#277babd6c87c6d6fcd2bb26bfa0b5708"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#277babd6c87c6d6fcd2bb26bfa0b5708"><span class="id" title="notation">&gt;&gt;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#5cb80321c7d7396b2ae1a6d4a6e54c61"><span class="id" title="notation">::=^</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.M"><span class="id" title="definition">M</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>%<span class="id" title="var">list</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.SCHEDULE"><span class="id" title="definition">SCHEDULE</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">sigma0</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.sigma"><span class="id" title="definition">sigma</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.r00"><span class="id" title="axiom">r00</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.r01"><span class="id" title="axiom">r01</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.s0"><span class="id" title="axiom">s0</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.MM"><span class="id" title="definition">MM</span></a> 15) <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">sigma1</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.sigma"><span class="id" title="definition">sigma</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.r10"><span class="id" title="axiom">r10</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.r11"><span class="id" title="axiom">r11</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.s1"><span class="id" title="axiom">s1</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.MM"><span class="id" title="definition">MM</span></a> 2) <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.M"><span class="id" title="definition">M</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.MM"><span class="id" title="definition">MM</span></a> 7 <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#sigma0"><span class="id" title="variable">sigma0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#sigma1"><span class="id" title="variable">sigma1</span></a>.<br/>
</div>

<div class="doc">
This completes the code for message scheduling 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">End</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.MessageSchedule"><span class="id" title="section">MessageSchedule</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="SHA2.correctnessNextIdx"><span class="id" title="lemma">correctnessNextIdx</span></a> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" title="definition">proj1_sig</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.nextIdx"><span class="id" title="definition">nextIdx</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#n"><span class="id" title="variable">n</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#n"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Nat.html#0984ed888197c75c46fdcd2f323d822d"><span class="id" title="notation">mod</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a>)%<span class="id" title="var">nat</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">n</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">do</span> 16 (<span class="id" title="tactic">destruct</span> <span class="id" title="var">n</span>; <span class="id" title="tactic">trivial</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab106"></a><h1 class="section">Sha2 round.</h1>


<div class="paragraph"> </div>

      The Sha2 hash function keeps track of a state in the variables
      a-h, and updates the state according to the equation.

<div class="paragraph"> </div>

      <tt>
      a' = t1 + t2
      b' = a
      c' = b
      d' = c
      e' = d + t1
      f' = e
      g' = f
      h' = g
      </tt>
<div class="paragraph"> </div>

      where

<div class="paragraph"> </div>

      <tt>
      t1 = h + k + m + 𝚺₁(e) + CH e f g
      t2 = 𝚺₀(a) + MAJ a b c
      </tt>
<div class="paragraph"> </div>

      where the 𝚺 functions are of the form
      𝚺 (x) = RotR(x , r0) ^ RotR(x,r1) ^ RotR(x,r2)
      We capture the state as a record of variables.

<div class="paragraph"> </div>

     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <a name="SHA2.State"><span class="id" title="record">State</span></a> := { <a name="SHA2.A"><span class="id" title="projection">A</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="SHA2.B"><span class="id" title="projection">B</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="SHA2.C"><span class="id" title="projection">C</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="SHA2.D"><span class="id" title="projection">D</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="SHA2.E"><span class="id" title="projection">E</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="SHA2.F"><span class="id" title="projection">F</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="SHA2.G"><span class="id" title="projection">G</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a name="SHA2.H"><span class="id" title="projection">H</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}.<br/>

<br/>
</div>

<div class="doc">
The starting state 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.state0"><span class="id" title="definition">state0</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.State"><span class="id" title="record">State</span></a>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">A</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">a</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">B</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">b</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">C</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">c</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">D</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">d</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">E</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">e</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">F</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">f</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">G</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">g</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">H</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">h</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>

<br/>
</div>

<div class="doc">
Instead of using different variables for each round we just
        update the state by permuting elements
     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.newState"><span class="id" title="definition">newState</span></a> (<span class="id" title="var">s</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.State"><span class="id" title="record">State</span></a>):=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">A</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">H</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">s</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">B</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">A</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">s</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">C</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">B</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">s</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">D</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">C</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">s</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">E</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">D</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">s</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">F</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">E</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">s</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">G</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">F</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">s</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">H</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">G</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">s</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.sig"><span class="id" title="definition">sig</span></a> <span class="id" title="var">r0</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> (<span class="id" title="var">x</span> : <a class="idref" href="Verse.Verse.Types.Internal.html#typeDenote"><span class="id" title="definition">typeDenote</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a> : <span class="id" title="keyword">Type</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Verse.Verse.Semantics.html#a0bb33bc9a339295219bfa660c0f379c"><span class="id" title="notation">RotR</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r2"><span class="id" title="variable">r2</span></a> <a class="idref" href="Verse.Verse.Semantics.html#da2ab3c0109efde7f6b7a4a15101f35a"><span class="id" title="notation">XOR</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Verse.Verse.Semantics.html#a0bb33bc9a339295219bfa660c0f379c"><span class="id" title="notation">RotR</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r1"><span class="id" title="variable">r1</span></a> <a class="idref" href="Verse.Verse.Semantics.html#da2ab3c0109efde7f6b7a4a15101f35a"><span class="id" title="notation">XOR</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Verse.Verse.Semantics.html#a0bb33bc9a339295219bfa660c0f379c"><span class="id" title="notation">RotR</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r0"><span class="id" title="variable">r0</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.Sigma"><span class="id" title="definition">Sigma</span></a> <span class="id" title="var">r0</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> (<span class="id" title="var">x</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e01e4fa8e4b5deaa3d50a75b833817cc"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e01e4fa8e4b5deaa3d50a75b833817cc"><span class="id" title="notation">&gt;&gt;&gt;</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e01e4fa8e4b5deaa3d50a75b833817cc"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r2"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r1"><span class="id" title="variable">r1</span></a><a class="idref" href="Verse.Verse.Language.Pretty.html#e01e4fa8e4b5deaa3d50a75b833817cc"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#5cb80321c7d7396b2ae1a6d4a6e54c61"><span class="id" title="notation">::=^</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#5c99430fe87eff99074c25ada9701c19"><span class="id" title="notation">::=&gt;&gt;&gt;</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#5c99430fe87eff99074c25ada9701c19"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r1"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r0"><span class="id" title="variable">r0</span></a><a class="idref" href="Verse.Verse.Language.Pretty.html#5c99430fe87eff99074c25ada9701c19"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>    <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#5cb80321c7d7396b2ae1a6d4a6e54c61"><span class="id" title="notation">::=^</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#5c99430fe87eff99074c25ada9701c19"><span class="id" title="notation">::=&gt;&gt;&gt;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r0"><span class="id" title="variable">r0</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Pretty.html#194ef9582b19dc4f933d97fba7f36e9b"><span class="id" title="notation">ASSERT</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">Val</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.sig"><span class="id" title="definition">sig</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r0"><span class="id" title="variable">r0</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r1"><span class="id" title="variable">r1</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r2"><span class="id" title="variable">r2</span></a> (<a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">Val</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#x"><span class="id" title="variable">x</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>%<span class="id" title="var">list</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.Sigma0"><span class="id" title="definition">Sigma0</span></a> (<span class="id" title="var">s</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.State"><span class="id" title="record">State</span></a>) := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Sigma"><span class="id" title="definition">Sigma</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.R00"><span class="id" title="axiom">R00</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.R01"><span class="id" title="axiom">R01</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.R02"><span class="id" title="axiom">R02</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.Sigma1"><span class="id" title="definition">Sigma1</span></a> (<span class="id" title="var">s</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.State"><span class="id" title="record">State</span></a>) := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Sigma"><span class="id" title="definition">Sigma</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.R10"><span class="id" title="axiom">R10</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.R11"><span class="id" title="axiom">R11</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.R12"><span class="id" title="axiom">R12</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.E"><span class="id" title="projection">E</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a>).<br/>

<br/>
</div>

<div class="doc">
The CH and the MAJ functions are also defined computing their result
        into the temp variable temp
     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.CH"><span class="id" title="definition">CH</span></a> (<span class="id" title="var">s</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.State"><span class="id" title="record">State</span></a>) : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a>:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#49fcb6331f9408e6cc2a46935ebde8ca"><span class="id" title="notation">::=~</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.E"><span class="id" title="projection">E</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#dc3ddc621107d5976c8e43171a9d7186"><span class="id" title="notation">::=&amp;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.G"><span class="id" title="projection">G</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#3d9d72ad686ce03b433890d080b1de31"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.E"><span class="id" title="projection">E</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#3d9d72ad686ce03b433890d080b1de31"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.F"><span class="id" title="projection">F</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#5cb80321c7d7396b2ae1a6d4a6e54c61"><span class="id" title="notation">::=^</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Pretty.html#194ef9582b19dc4f933d97fba7f36e9b"><span class="id" title="notation">ASSERT</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.E"><span class="id" title="projection">E</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#455da5dfd62b69090690610593d302cb"><span class="id" title="notation">HAS</span></a> <span class="id" title="var">e</span><a class="idref" href="Verse.Verse.Language.Pretty.html#455da5dfd62b69090690610593d302cb"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.F"><span class="id" title="projection">F</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#455da5dfd62b69090690610593d302cb"><span class="id" title="notation">HAS</span></a> <span class="id" title="var">f</span><a class="idref" href="Verse.Verse.Language.Pretty.html#455da5dfd62b69090690610593d302cb"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.G"><span class="id" title="projection">G</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#c9345003135a94ba8c64248190f037c0"><span class="id" title="notation">HAS</span></a> <span class="id" title="var">g</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Pretty.html#c9345003135a94ba8c64248190f037c0"><span class="id" title="notation">IN</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">Val</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Verse.Verse.Semantics.html#da2ab3c0109efde7f6b7a4a15101f35a"><span class="id" title="notation">(</span></a><span class="id" title="var">e</span> <a class="idref" href="Verse.Verse.Semantics.html#26c88b7222a6138983c3e49a1616f9d2"><span class="id" title="notation">AND</span></a> <span class="id" title="var">f</span><a class="idref" href="Verse.Verse.Semantics.html#da2ab3c0109efde7f6b7a4a15101f35a"><span class="id" title="notation">)</span></a> <a class="idref" href="Verse.Verse.Semantics.html#da2ab3c0109efde7f6b7a4a15101f35a"><span class="id" title="notation">XOR</span></a> <a class="idref" href="Verse.Verse.Semantics.html#da2ab3c0109efde7f6b7a4a15101f35a"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.Semantics.html#2bc3893c914925aaf63b186791b395fd"><span class="id" title="notation">NOT</span></a> <span class="id" title="var">e</span> <a class="idref" href="Verse.Verse.Semantics.html#26c88b7222a6138983c3e49a1616f9d2"><span class="id" title="notation">AND</span></a> <span class="id" title="var">g</span><a class="idref" href="Verse.Verse.Semantics.html#da2ab3c0109efde7f6b7a4a15101f35a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>%<span class="id" title="var">list</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.MAJ"><span class="id" title="definition">MAJ</span></a> (<span class="id" title="var">s</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.State"><span class="id" title="record">State</span></a>) : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a>  <a class="idref" href="Verse.Verse.Language.Pretty.html#999781d535237d922f449c9fd06ec371"><span class="id" title="notation">::=</span></a>  <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.B"><span class="id" title="projection">B</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#999781d535237d922f449c9fd06ec371"><span class="id" title="notation">|</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.C"><span class="id" title="projection">C</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a>  <a class="idref" href="Verse.Verse.Language.Pretty.html#dc3ddc621107d5976c8e43171a9d7186"><span class="id" title="notation">::=&amp;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a>    <a class="idref" href="Verse.Verse.Language.Pretty.html#3d9d72ad686ce03b433890d080b1de31"><span class="id" title="notation">::=</span></a>  <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.B"><span class="id" title="projection">B</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#3d9d72ad686ce03b433890d080b1de31"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.C"><span class="id" title="projection">C</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a>  <a class="idref" href="Verse.Verse.Language.Pretty.html#b56946c920ec4d6ffcf5c1ff7ca19d58"><span class="id" title="notation">::=|</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Pretty.html#194ef9582b19dc4f933d97fba7f36e9b"><span class="id" title="notation">ASSERT</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#455da5dfd62b69090690610593d302cb"><span class="id" title="notation">HAS</span></a> <span class="id" title="var">a</span><a class="idref" href="Verse.Verse.Language.Pretty.html#455da5dfd62b69090690610593d302cb"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.B"><span class="id" title="projection">B</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#455da5dfd62b69090690610593d302cb"><span class="id" title="notation">HAS</span></a> <span class="id" title="var">b</span><a class="idref" href="Verse.Verse.Language.Pretty.html#455da5dfd62b69090690610593d302cb"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.C"><span class="id" title="projection">C</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#c9345003135a94ba8c64248190f037c0"><span class="id" title="notation">HAS</span></a> <span class="id" title="var">c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Pretty.html#c9345003135a94ba8c64248190f037c0"><span class="id" title="notation">IN</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">Val</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Verse.Verse.Semantics.html#ef107ab3999998c15c70f9927136890a"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span> <a class="idref" href="Verse.Verse.Semantics.html#26c88b7222a6138983c3e49a1616f9d2"><span class="id" title="notation">AND</span></a> <span class="id" title="var">b</span><a class="idref" href="Verse.Verse.Semantics.html#ef107ab3999998c15c70f9927136890a"><span class="id" title="notation">)</span></a> <a class="idref" href="Verse.Verse.Semantics.html#ef107ab3999998c15c70f9927136890a"><span class="id" title="notation">OR</span></a> <a class="idref" href="Verse.Verse.Semantics.html#ef107ab3999998c15c70f9927136890a"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span> <a class="idref" href="Verse.Verse.Semantics.html#26c88b7222a6138983c3e49a1616f9d2"><span class="id" title="notation">AND</span></a> <span class="id" title="var">c</span><a class="idref" href="Verse.Verse.Semantics.html#ef107ab3999998c15c70f9927136890a"><span class="id" title="notation">)</span></a> <a class="idref" href="Verse.Verse.Semantics.html#ef107ab3999998c15c70f9927136890a"><span class="id" title="notation">OR</span></a> <a class="idref" href="Verse.Verse.Semantics.html#ef107ab3999998c15c70f9927136890a"><span class="id" title="notation">(</span></a><span class="id" title="var">b</span> <a class="idref" href="Verse.Verse.Semantics.html#26c88b7222a6138983c3e49a1616f9d2"><span class="id" title="notation">AND</span></a> <span class="id" title="var">c</span><a class="idref" href="Verse.Verse.Semantics.html#ef107ab3999998c15c70f9927136890a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>.<br/>

<br/>
</div>

<div class="doc">
The heart of the hash algorithm a single round where we update
        the state held in the variables <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.a"><span class="id" title="variable">a</span></a></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.b"><span class="id" title="variable">b</span></a></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.c"><span class="id" title="variable">c</span></a></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.d"><span class="id" title="variable">d</span></a></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.e"><span class="id" title="variable">e</span></a></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.g"><span class="id" title="variable">g</span></a></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.h"><span class="id" title="variable">h</span></a></span> according to
        the procedure STEP. This step requires the message word <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.M"><span class="id" title="definition">M</span></a></span>
        applicable for that round computed the message schedule, and
        the round constant <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.K"><span class="id" title="definition">K</span></a></span>.
     
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.STEP"><span class="id" title="definition">STEP</span></a> (<span class="id" title="var">s</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.State"><span class="id" title="record">State</span></a>)(<span class="id" title="var">M</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>)(<span class="id" title="var">K</span> : <a class="idref" href="Verse.Verse.Types.html#constant"><span class="id" title="definition">constant</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>) : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#a23f2aca9935b18f2f807af2e73f752e"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.H"><span class="id" title="projection">H</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#a23f2aca9935b18f2f807af2e73f752e"><span class="id" title="notation">+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#K"><span class="id" title="variable">K</span></a>  <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>  <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#M"><span class="id" title="variable">M</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.CH"><span class="id" title="definition">CH</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a>        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a>  <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Sigma1"><span class="id" title="definition">Sigma1</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a>   <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.D"><span class="id" title="projection">D</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Sigma0"><span class="id" title="definition">Sigma0</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a>    <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.MAJ"><span class="id" title="definition">MAJ</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a>       <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.H"><span class="id" title="projection">H</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#a23f2aca9935b18f2f807af2e73f752e"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#a23f2aca9935b18f2f807af2e73f752e"><span class="id" title="notation">+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#194ef9582b19dc4f933d97fba7f36e9b"><span class="id" title="notation">ASSERT</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#c4917209bffb1781f4cc5d0a0a60fb96"><span class="id" title="notation">HAD</span></a> <span class="id" title="var">a</span><a class="idref" href="Verse.Verse.Language.Pretty.html#c4917209bffb1781f4cc5d0a0a60fb96"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.B"><span class="id" title="projection">B</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#c4917209bffb1781f4cc5d0a0a60fb96"><span class="id" title="notation">HAD</span></a> <span class="id" title="var">b</span><a class="idref" href="Verse.Verse.Language.Pretty.html#c4917209bffb1781f4cc5d0a0a60fb96"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.C"><span class="id" title="projection">C</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#c4917209bffb1781f4cc5d0a0a60fb96"><span class="id" title="notation">HAD</span></a> <span class="id" title="var">c</span><a class="idref" href="Verse.Verse.Language.Pretty.html#c4917209bffb1781f4cc5d0a0a60fb96"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.D"><span class="id" title="projection">D</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#c4917209bffb1781f4cc5d0a0a60fb96"><span class="id" title="notation">HAD</span></a> <span class="id" title="var">d</span><a class="idref" href="Verse.Verse.Language.Pretty.html#c4917209bffb1781f4cc5d0a0a60fb96"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.E"><span class="id" title="projection">E</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#c4917209bffb1781f4cc5d0a0a60fb96"><span class="id" title="notation">HAD</span></a> <span class="id" title="var">e</span><a class="idref" href="Verse.Verse.Language.Pretty.html#c4917209bffb1781f4cc5d0a0a60fb96"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.F"><span class="id" title="projection">F</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#c4917209bffb1781f4cc5d0a0a60fb96"><span class="id" title="notation">HAD</span></a> <span class="id" title="var">f</span><a class="idref" href="Verse.Verse.Language.Pretty.html#c4917209bffb1781f4cc5d0a0a60fb96"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.G"><span class="id" title="projection">G</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#c4917209bffb1781f4cc5d0a0a60fb96"><span class="id" title="notation">HAD</span></a> <span class="id" title="var">g</span><a class="idref" href="Verse.Verse.Language.Pretty.html#c4917209bffb1781f4cc5d0a0a60fb96"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.H"><span class="id" title="projection">H</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#69e2d97cbcf0111da88f3471ece4becd"><span class="id" title="notation">HAD</span></a> <span class="id" title="var">h</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Pretty.html#69e2d97cbcf0111da88f3471ece4becd"><span class="id" title="notation">IN</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">s'</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.newState"><span class="id" title="definition">newState</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">S1</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.sig"><span class="id" title="definition">sig</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.R10"><span class="id" title="axiom">R10</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.R11"><span class="id" title="axiom">R11</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.R12"><span class="id" title="axiom">R12</span></a> <span class="id" title="var">e</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">ch</span> := <a class="idref" href="Verse.Verse.Semantics.html#da2ab3c0109efde7f6b7a4a15101f35a"><span class="id" title="notation">(</span></a><span class="id" title="var">e</span> <a class="idref" href="Verse.Verse.Semantics.html#26c88b7222a6138983c3e49a1616f9d2"><span class="id" title="notation">AND</span></a> <span class="id" title="var">f</span><a class="idref" href="Verse.Verse.Semantics.html#da2ab3c0109efde7f6b7a4a15101f35a"><span class="id" title="notation">)</span></a> <a class="idref" href="Verse.Verse.Semantics.html#da2ab3c0109efde7f6b7a4a15101f35a"><span class="id" title="notation">XOR</span></a> <a class="idref" href="Verse.Verse.Semantics.html#da2ab3c0109efde7f6b7a4a15101f35a"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.Semantics.html#2bc3893c914925aaf63b186791b395fd"><span class="id" title="notation">NOT</span></a> <span class="id" title="var">e</span> <a class="idref" href="Verse.Verse.Semantics.html#26c88b7222a6138983c3e49a1616f9d2"><span class="id" title="notation">AND</span></a> <span class="id" title="var">g</span><a class="idref" href="Verse.Verse.Semantics.html#da2ab3c0109efde7f6b7a4a15101f35a"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">temp1</span> := <span class="id" title="var">h</span> <a class="idref" href="Verse.Verse.Word.html#2d4b1f5d3d5b220552d03b8fbf3577b8"><span class="id" title="notation">+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#S1"><span class="id" title="variable">S1</span></a> <a class="idref" href="Verse.Verse.Word.html#2d4b1f5d3d5b220552d03b8fbf3577b8"><span class="id" title="notation">+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#ch"><span class="id" title="variable">ch</span></a> <a class="idref" href="Verse.Verse.Word.html#2d4b1f5d3d5b220552d03b8fbf3577b8"><span class="id" title="notation">+</span></a> <a class="idref" href="Verse.Verse.Word.html#6451a62582f031cf9b1d5ad156a0c4aa"><span class="id" title="notation">[[</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#K"><span class="id" title="variable">K</span></a><a class="idref" href="Verse.Verse.Word.html#6451a62582f031cf9b1d5ad156a0c4aa"><span class="id" title="notation">]]</span></a> <a class="idref" href="Verse.Verse.Word.html#2d4b1f5d3d5b220552d03b8fbf3577b8"><span class="id" title="notation">+</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">Val</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#M"><span class="id" title="variable">M</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">S0</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.sig"><span class="id" title="definition">sig</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.R00"><span class="id" title="axiom">R00</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.R01"><span class="id" title="axiom">R01</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.R02"><span class="id" title="axiom">R02</span></a> <span class="id" title="var">a</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">maj</span> := <a class="idref" href="Verse.Verse.Semantics.html#ef107ab3999998c15c70f9927136890a"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span> <a class="idref" href="Verse.Verse.Semantics.html#26c88b7222a6138983c3e49a1616f9d2"><span class="id" title="notation">AND</span></a> <span class="id" title="var">b</span><a class="idref" href="Verse.Verse.Semantics.html#ef107ab3999998c15c70f9927136890a"><span class="id" title="notation">)</span></a> <a class="idref" href="Verse.Verse.Semantics.html#ef107ab3999998c15c70f9927136890a"><span class="id" title="notation">OR</span></a> <a class="idref" href="Verse.Verse.Semantics.html#ef107ab3999998c15c70f9927136890a"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span> <a class="idref" href="Verse.Verse.Semantics.html#26c88b7222a6138983c3e49a1616f9d2"><span class="id" title="notation">AND</span></a> <span class="id" title="var">c</span><a class="idref" href="Verse.Verse.Semantics.html#ef107ab3999998c15c70f9927136890a"><span class="id" title="notation">)</span></a> <a class="idref" href="Verse.Verse.Semantics.html#ef107ab3999998c15c70f9927136890a"><span class="id" title="notation">OR</span></a> <a class="idref" href="Verse.Verse.Semantics.html#ef107ab3999998c15c70f9927136890a"><span class="id" title="notation">(</span></a><span class="id" title="var">b</span> <a class="idref" href="Verse.Verse.Semantics.html#26c88b7222a6138983c3e49a1616f9d2"><span class="id" title="notation">AND</span></a> <span class="id" title="var">c</span><a class="idref" href="Verse.Verse.Semantics.html#ef107ab3999998c15c70f9927136890a"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">temp2</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#S0"><span class="id" title="variable">S0</span></a> <a class="idref" href="Verse.Verse.Word.html#2d4b1f5d3d5b220552d03b8fbf3577b8"><span class="id" title="notation">+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#maj"><span class="id" title="variable">maj</span></a> <span class="id" title="keyword">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">Val</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.H"><span class="id" title="projection">H</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s'"><span class="id" title="variable">s'</span></a><a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <span class="id" title="var">g</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">Val</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.G"><span class="id" title="projection">G</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s'"><span class="id" title="variable">s'</span></a><a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">Val</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.F"><span class="id" title="projection">F</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s'"><span class="id" title="variable">s'</span></a><a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">Val</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.E"><span class="id" title="projection">E</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s'"><span class="id" title="variable">s'</span></a><a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <span class="id" title="var">d</span> <a class="idref" href="Verse.Verse.Word.html#2d4b1f5d3d5b220552d03b8fbf3577b8"><span class="id" title="notation">+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#temp1"><span class="id" title="variable">temp1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">Val</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.D"><span class="id" title="projection">D</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s'"><span class="id" title="variable">s'</span></a><a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <span class="id" title="var">c</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">Val</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.C"><span class="id" title="projection">C</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s'"><span class="id" title="variable">s'</span></a><a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">Val</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.B"><span class="id" title="projection">B</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s'"><span class="id" title="variable">s'</span></a><a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d82a7d96d3659d805ffe732283716822"><span class="id" title="notation">∧</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">Val</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#s'"><span class="id" title="variable">s'</span></a><a class="idref" href="Verse.Verse.Language.Pretty.html#68cb272aa26d7fbab1a1b394332586c9"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#temp1"><span class="id" title="variable">temp1</span></a> <a class="idref" href="Verse.Verse.Word.html#2d4b1f5d3d5b220552d03b8fbf3577b8"><span class="id" title="notation">+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#temp2"><span class="id" title="variable">temp2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a>.<br/>

<br/>
</div>

<div class="doc">
Having defined the <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.STEP"><span class="id" title="definition">STEP</span></a></span> we look at a single round. A round
        <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a></span> consists of an application of the <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.STEP"><span class="id" title="definition">STEP</span></a></span> together with
        modifying the message for use in round <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a></span> <span class="inlinecode">+</span>
        <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a></span>. However, the last <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a></span> many rounds need
        not to update the message word as they are not going to be
        used. We now describe the two variants.  
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.ROUND_WITH_SCHEDULE"><span class="id" title="definition">ROUND_WITH_SCHEDULE</span></a> <span class="id" title="var">stAndIdx</span> <span class="id" title="var">K</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#stAndIdx"><span class="id" title="variable">stAndIdx</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">st</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> @<span class="id" title="var">exist</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">mIdx</span> <span class="id" title="var">mIdxBoundPf</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Mesg</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.M"><span class="id" title="definition">M</span></a> <span class="id" title="var">mIdx</span> <span class="id" title="var">mIdxBoundPf</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.STEP"><span class="id" title="definition">STEP</span></a> <span class="id" title="var">st</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#Mesg"><span class="id" title="variable">Mesg</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#K"><span class="id" title="variable">K</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.SCHEDULE"><span class="id" title="definition">SCHEDULE</span></a> <span class="id" title="var">mIdx</span> <span class="id" title="var">mIdxBoundPf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.ROUND_WITHOUT_SCHEDULE"><span class="id" title="definition">ROUND_WITHOUT_SCHEDULE</span></a> <span class="id" title="var">stAndIdx</span> <span class="id" title="var">K</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#stAndIdx"><span class="id" title="variable">stAndIdx</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">st</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> @<span class="id" title="var">exist</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">mIdx</span> <span class="id" title="var">mIdxBoundPf</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Mesg</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.M"><span class="id" title="definition">M</span></a> <span class="id" title="var">mIdx</span> <span class="id" title="var">mIdxBoundPf</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.STEP"><span class="id" title="definition">STEP</span></a> <span class="id" title="var">st</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#Mesg"><span class="id" title="variable">Mesg</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#K"><span class="id" title="variable">K</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <a name="SHA2.Program.GenerateRounds"><span class="id" title="section">GenerateRounds</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.MessageIndex"><span class="id" title="definition">MessageIndex</span></a>  := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">{</span></a> <span class="id" title="var">r</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">:</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">|</span></a> <span class="id" title="var">r</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#989c98e7ddd65d5bf37c334ff2076de8"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#72ca3fac4636a1b19c963b12162882cf"><span class="id" title="notation">}</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.Accumulator"><span class="id" title="definition">Accumulator</span></a> := (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.State"><span class="id" title="record">State</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.MessageIndex"><span class="id" title="definition">MessageIndex</span></a>)%<span class="id" title="var">type</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.next"><span class="id" title="definition">next</span></a> (<span class="id" title="var">acc</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Accumulator"><span class="id" title="definition">Accumulator</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#acc"><span class="id" title="variable">acc</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a>@<span class="id" title="var">exist</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">idx</span> <span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.newState"><span class="id" title="definition">newState</span></a> <span class="id" title="var">s</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.nextIdx"><span class="id" title="definition">nextIdx</span></a> <span class="id" title="var">idx</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="SHA2.Program.GenerateRounds.genCode"><span class="id" title="variable">genCode</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Accumulator"><span class="id" title="definition">Accumulator</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="Verse.Verse.Types.html#constant"><span class="id" title="definition">constant</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="SHA2.generateRounds"><span class="id" title="definition">generateRounds</span></a> (<span class="id" title="var">acc</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Accumulator"><span class="id" title="definition">Accumulator</span></a>) (<span class="id" title="var">Ks</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="Verse.Verse.Types.html#constant"><span class="id" title="definition">constant</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Accumulator"><span class="id" title="definition">Accumulator</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="keyword">match</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#Ks"><span class="id" title="variable">Ks</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a> <span class="id" title="var">ks</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cde</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.GenerateRounds.genCode"><span class="id" title="variable">genCode</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#acc"><span class="id" title="variable">acc</span></a> <span class="id" title="var">k</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">cdeRest</span>, <span class="id" title="var">stp</span>) := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#generateRounds"><span class="id" title="definition">generateRounds</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.next"><span class="id" title="definition">next</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#acc"><span class="id" title="variable">acc</span></a>) <span class="id" title="var">ks</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#cde"><span class="id" title="variable">cde</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#cdeRest"><span class="id" title="variable">cdeRest</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#stp"><span class="id" title="variable">stp</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">]</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#acc"><span class="id" title="variable">acc</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">End</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.GenerateRounds"><span class="id" title="section">GenerateRounds</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <a name="SHA2.splitAt"><span class="id" title="definition">splitAt</span></a> {<span class="id" title="var">A</span>}(<span class="id" title="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)(<span class="id" title="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#A"><span class="id" title="variable">A</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#A"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#A"><span class="id" title="variable">A</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#l"><span class="id" title="variable">l</span></a>,<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#n"><span class="id" title="variable">n</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">x</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a><span class="id" title="var">xs</span>, <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <span class="id" title="var">m</span> ⇒ <span class="id" title="keyword">match</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#splitAt"><span class="id" title="definition">splitAt</span></a> <span class="id" title="var">m</span> <span class="id" title="var">xs</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">ys</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><span class="id" title="var">zs</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a> <span class="id" title="var">ys</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <span class="id" title="var">zs</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>      , <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">[</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#145bedf8a5d4a541831f3f70db03085c"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#l"><span class="id" title="variable">l</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.ALL_ROUNDS"><span class="id" title="definition">ALL_ROUNDS</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Ks</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.Vector.html#to_list"><span class="id" title="definition">Vector.to_list</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.KVec"><span class="id" title="axiom">KVec</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">KsInit</span>, <span class="id" title="var">KsLast</span>) := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.splitAt"><span class="id" title="definition">splitAt</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.ROUNDS"><span class="id" title="axiom">ROUNDS</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a>)  <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#Ks"><span class="id" title="variable">Ks</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">acc0</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.state0"><span class="id" title="definition">state0</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> @<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#exist"><span class="id" title="constructor">exist</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> 0 <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.zltBlockSize"><span class="id" title="definition">zltBlockSize</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">cd1</span>, <span class="id" title="var">acc1</span>) := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.generateRounds"><span class="id" title="definition">generateRounds</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.ROUND_WITH_SCHEDULE"><span class="id" title="definition">ROUND_WITH_SCHEDULE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#acc0"><span class="id" title="variable">acc0</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#KsInit"><span class="id" title="variable">KsInit</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">cd2</span>,<span class="id" title="var">_</span>) := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.generateRounds"><span class="id" title="definition">generateRounds</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.ROUND_WITHOUT_SCHEDULE"><span class="id" title="definition">ROUND_WITHOUT_SCHEDULE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#acc1"><span class="id" title="variable">acc1</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#KsLast"><span class="id" title="variable">KsLast</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#cd1"><span class="id" title="variable">cd1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#cd2"><span class="id" title="variable">cd2</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.UPDATE_ITH"><span class="id" title="definition">UPDATE_ITH</span></a> (<span class="id" title="var">i</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">pf</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#989c98e7ddd65d5bf37c334ff2076de8"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#HASH_SIZE"><span class="id" title="definition">HASH_SIZE</span></a>) : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">verse</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.STATE"><span class="id" title="definition">STATE</span></a> <span class="id" title="var">i</span> <span class="id" title="var">_</span> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.hash"><span class="id" title="variable">hash</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#6990918f84290fa34850a4b77307cea9"><span class="id" title="notation">[-</span></a> <span class="id" title="var">i</span> <a class="idref" href="Verse.Verse.Language.Pretty.html#6990918f84290fa34850a4b77307cea9"><span class="id" title="notation">-]</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.UPDATE"><span class="id" title="definition">UPDATE</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Verse.Verse.Language.Utils.html#foreach"><span class="id" title="definition">foreach</span></a> (<a class="idref" href="Verse.Verse.Language.Utils.html#indices"><span class="id" title="definition">indices</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.hash"><span class="id" title="variable">hash</span></a>) <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.UPDATE_ITH"><span class="id" title="definition">UPDATE_ITH</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.Language.Utils.html#moveBackCache"><span class="id" title="definition">moveBackCache</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.hash"><span class="id" title="variable">hash</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.STATE"><span class="id" title="definition">STATE</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.sha2"><span class="id" title="definition">sha2</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#iterator"><span class="id" title="record">iterator</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Block"><span class="id" title="definition">Block</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">setup</span></a>   <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">LOAD_STATE</span></a><a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">process</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">:=</span></a> <span class="id" title="keyword">fun</span> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">block</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">⇒</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">(</span></a><a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">LOAD_BLOCK</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">block</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">++</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">ALL_ROUNDS</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">++</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">UPDATE</span></a><a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">);</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">finalise</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">[</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Program"><span class="id" title="section">Program</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.scSTEP"><span class="id" title="definition">scSTEP</span></a> <span class="id" title="var">v</span> <span class="id" title="var">t</span> <span class="id" title="var">tp</span> <span class="id" title="var">temp</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span> <span class="id" title="var">d</span> <span class="id" title="var">e</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span> <span class="id" title="var">m</span> <span class="id" title="var">k</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.STEP"><span class="id" title="definition">STEP</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#t"><span class="id" title="variable">t</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#tp"><span class="id" title="variable">tp</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#temp"><span class="id" title="variable">temp</span></a> {| <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">A</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">a</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">B</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">b</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">C</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">c</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">D</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">d</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">E</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">e</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">F</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">f</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">G</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">g</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">H</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Build_State"><span class="id" title="constructor">h</span></a> |} <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#k"><span class="id" title="variable">k</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.toProve"><span class="id" title="definition">toProve</span></a> : <span class="id" title="keyword">Prop</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">exParamProp</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.scSTEP"><span class="id" title="definition">scSTEP</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a name="SHA2.SigmaCorrect"><span class="id" title="lemma">SigmaCorrect</span></a> <span class="id" title="var">r0</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> (<span class="id" title="var">incr</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r0"><span class="id" title="variable">r0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#5b045077597c2458ff66998b6cb1d006"><span class="id" title="notation">≤</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r1"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#5b045077597c2458ff66998b6cb1d006"><span class="id" title="notation">≤</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r2"><span class="id" title="variable">r2</span></a>) (<span class="id" title="var">w</span> : <a class="idref" href="Verse.Verse.Types.Internal.html#typeDenote"><span class="id" title="definition">typeDenote</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a> : <span class="id" title="keyword">Type</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="Verse.Verse.Word.html#RotRW"><span class="id" title="definition">RotRW</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r0"><span class="id" title="variable">r0</span></a> (<a class="idref" href="Verse.Verse.Word.html#XorW"><span class="id" title="definition">XorW</span></a> (<a class="idref" href="Verse.Verse.Word.html#RotRW"><span class="id" title="definition">RotRW</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r1"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r0"><span class="id" title="variable">r0</span></a>) (<a class="idref" href="Verse.Verse.Word.html#XorW"><span class="id" title="definition">XorW</span></a> (<a class="idref" href="Verse.Verse.Word.html#RotRW"><span class="id" title="definition">RotRW</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r2"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r1"><span class="id" title="variable">r1</span></a>) <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#w"><span class="id" title="variable">w</span></a>) <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#w"><span class="id" title="variable">w</span></a>)) <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#w"><span class="id" title="variable">w</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#1c39bf18749e5cc609e83c0a0ba5a372"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Word.html#XorW"><span class="id" title="definition">XorW</span></a> (<a class="idref" href="Verse.Verse.Word.html#XorW"><span class="id" title="definition">XorW</span></a> (<a class="idref" href="Verse.Verse.Word.html#RotRW"><span class="id" title="definition">RotRW</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r2"><span class="id" title="variable">r2</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#w"><span class="id" title="variable">w</span></a>) (<a class="idref" href="Verse.Verse.Word.html#RotRW"><span class="id" title="definition">RotRW</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r1"><span class="id" title="variable">r1</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#w"><span class="id" title="variable">w</span></a>)) (<a class="idref" href="Verse.Verse.Word.html#RotRW"><span class="id" title="definition">RotRW</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#r0"><span class="id" title="variable">r0</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#w"><span class="id" title="variable">w</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="Verse.Verse.WordFacts.html#rotRDistrXor"><span class="id" title="lemma">rotRDistrXor</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="Verse.Verse.WordFacts.html#rotRCompose"><span class="id" title="lemma">rotRCompose</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Arith.Minus.html#le_plus_minus_r"><span class="id" title="lemma">Minus.le_plus_minus_r</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.proof"><span class="id" title="definition">proof</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.toProve"><span class="id" title="definition">toProve</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.SigmaCorrect"><span class="id" title="lemma">SigmaCorrect</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.increasing_R's"><span class="id" title="axiom">increasing_R's</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.SigmaCorrect"><span class="id" title="lemma">SigmaCorrect</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.increasing_R's"><span class="id" title="axiom">increasing_R's</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="Verse.Verse.WordFacts.html#AndComm"><span class="id" title="lemma">AndComm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="Verse.Verse.WordFacts.html#AndDistrOr"><span class="id" title="lemma">AndDistrOr</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Add</span> <span class="id" title="var">Ring</span> <span class="id" title="var">Here</span> : (<a class="idref" href="Verse.Verse.WordRing.html#mod_semi_ring"><span class="id" title="definition">mod_semi_ring</span></a> (4 <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">(</span></a>2 <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">(</span></a>2 <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Nat.html#4c362bcf0e947e2792a2e6989b44aeb0"><span class="id" title="notation">^</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#C.WordSize"><span class="id" title="axiom">WordSize</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#697e4695610f677ae98a52af81f779d2"><span class="id" title="notation">))</span></a>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">ring_simplify</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">ring_simplify</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2"><span class="id" title="module">SHA2</span></a>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>