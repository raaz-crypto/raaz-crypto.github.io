<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Verse.Verse.CryptoLib.poly1305.c.portable</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Verse.Verse.CryptoLib.poly1305.c.portable</h1>

<div class="code">

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Verse.Verse.html#"><span class="id" title="library">Verse</span></a>.<br/>
<span class="id" title="keyword">Require</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.Vector.html#"><span class="id" title="library">Vector</span></a>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">VectorNotations</span>.<br/>
<span class="id" title="keyword">Require</span> <a class="idref" href="Verse.Verse.Arch.C.html#"><span class="id" title="library">Verse.Arch.C</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab53"></a><h1 class="section">The poly1305 message hash.</h1>


<div class="paragraph"> </div>

Let <span class="inlinecode"><span class="id" title="var">𝔽</span></span> denote the finite field GF(2¹³⁰ - 5). The poly1305 MAC in
essence is just the evaluation of the message thought of as a
polynomial over the finite field <span class="inlinecode"><span class="id" title="var">𝔽</span></span>. Elements of this field can be
represented using 130 bit word. To get the polynomial corresponding to
the message <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.M"><span class="id" title="definition">M</span></a></span>, we divide it into blocks <span class="inlinecode"><span class="id" title="var">M<sub>i</sub></span></span> of 16 byte (128-bits)
with the possibility of the last block <span class="inlinecode"><span class="id" title="var">M<sub>t</sub></span></span> to be of less than 16
bytes. The message <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.M"><span class="id" title="definition">M</span></a></span> is then considered as the polynomial

<div class="paragraph"> </div>

<span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.M"><span class="id" title="definition">M</span></a>(<a class="idref" href="Verse.Verse.CryptoLib.chacha20.c.portable.html#Internal.X"><span class="id" title="definition">X</span></a>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.chacha20.common.html#C1"><span class="id" title="definition">C<sub>1</sub></span></a></span> <span class="inlinecode"><span class="id" title="var">X<sup>t</sup></span></span> <span class="inlinecode">+</span> <span class="inlinecode">...</span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">C<sub>i</sub></span></span> <span class="inlinecode"><span class="id" title="var">X<sup>t-i+1</sup></span></span> <span class="inlinecode">+</span> <span class="inlinecode">...</span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">C<sub>t</sub></span></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.chacha20.c.portable.html#Internal.X"><span class="id" title="definition">X</span></a></span>.

<div class="paragraph"> </div>

where the coefficient <span class="inlinecode"><span class="id" title="var">C<sub>i</sub></span></span> is the element in <span class="inlinecode"><span class="id" title="var">𝔽</span></span> whose least
significant bits are that of <span class="inlinecode"><span class="id" title="var">M<sub>i</sub></span></span> with an additional 1-bit appended to
it. Thus the length of <span class="inlinecode"><span class="id" title="var">C<sub>i</sub></span></span> in bits is one more than that of <span class="inlinecode"><span class="id" title="var">M<sub>i</sub></span></span>.

<div class="paragraph"> </div>

The poly1305 MAC for secrets <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a></span> and <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.K"><span class="id" title="definition">K</span></a></span> consists of computing <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.M"><span class="id" title="definition">M</span></a>(<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a>)</span> <span class="inlinecode">+</span>
<span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.K"><span class="id" title="definition">K</span></a></span> rounded to 128 bits. At the heart of any fast implementations is
therefore the Horner's method of evaluation of a polynomial: keep an
accumulator <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a></span> which starts with 0 and is updated using the step <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a></span>
<span class="inlinecode">:=</span> <span class="inlinecode">(<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">C<sub>i</sub></span>)</span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a></span>

<div class="paragraph"> </div>

 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Word"><span class="id" title="definition">Word</span></a>       := <a class="idref" href="Verse.Verse.Types.html#Word64"><span class="id" title="abbreviation">Word64</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a name="BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a> := 2.<br/>
<span class="id" title="keyword">Definition</span> <a name="Block"><span class="id" title="definition">Block</span></a>      := <a class="idref" href="Verse.Verse.Types.html#Array"><span class="id" title="definition">Array</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a> <a class="idref" href="Verse.Verse.Types.Internal.html#littleE"><span class="id" title="constructor">littleE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Word"><span class="id" title="definition">Word</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab54"></a><h2 class="section">Arithmetic over <span class="inlinecode"><span class="id" title="var">𝔽</span></span>.</h2>


<div class="paragraph"> </div>

In C the biggest supported word type is the type of 64-bit word. This
means that we would need multiple 64-bit "Limbs" to represent a single
element of <span class="inlinecode"><span class="id" title="var">𝔽</span></span>. Also we need to have enough left over bits so as to
ensure that bits do not overflow during arithmetic and that we
propagate carries correctly. We need enough additional vacant bits in
the 64-bit limbs so that the update <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode">(<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">C<sub>i</sub></span>)</span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a></span> can be done
without overflows.

<div class="paragraph"> </div>

The poly1305 standard enforces that the parameter <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a></span> in <span class="inlinecode"><span class="id" title="var">𝔽</span></span> is of
128-bit. To facilitate the use of 64-bit limbs it is additionally
enforced that certain bits of <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a></span> are zeros. If <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a></span> in base 2³² is
expressed as

<div class="paragraph"> </div>

<span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>32</sup></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r<sub>2</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>64</sup></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r3"><span class="id" title="variable">r<sub>3</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>96</sup></span>.</span>

<div class="paragraph"> </div>

Then the restrictions on <span class="inlinecode"><span class="id" title="var">r<sub>i</sub></span></span> are

<div class="paragraph"> </div>

<ul class="doclist">
<li> The most significant 4-bits of <span class="inlinecode"><span class="id" title="var">r<sub>i</sub></span></span> are all zero.

<div class="paragraph"> </div>


</li>
<li> All except r₀ have their bottom 2-bits as zero.

</li>
</ul>

<div class="paragraph"> </div>


<div class="paragraph"> </div>

We have the following representation of for the value R and the
accumulator A.

<div class="paragraph"> </div>

<ul class="doclist">
<li> The quantity <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a></span> is represented as 4x64-bit registers <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a>,..,<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r3"><span class="id" title="variable">r<sub>3</sub></span></a></span>
  where each <span class="inlinecode"><span class="id" title="var">r<sub>i</sub></span></span> contains 32-bits each. Due to the restrictions on
  the allowed value of <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a></span>, each of the <span class="inlinecode"><span class="id" title="var">r<sub>i</sub></span></span>' have only the least 28
  bit significant.

<div class="paragraph"> </div>


</li>
<li> The accumulator <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a></span> can hold arbitrary element of <span class="inlinecode"><span class="id" title="var">𝔽</span></span> which
  requires 130-bits. We divide these 130 bits into registers <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a>..<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span>
  as follows.

<div class="paragraph"> </div>

<ul class="doclist">
<li> Registers <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a>..<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a></span> contains 32-bits each thereby accounting for
    the least significant 128-bits.

<div class="paragraph"> </div>


</li>
<li> The register <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> contains the remaining 2-bits.

</li>
</ul>

</li>
</ul>

<div class="paragraph"> </div>


</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Limb"><span class="id" title="definition">Limb</span></a>      := <a class="idref" href="Verse.Verse.Types.html#Word64"><span class="id" title="abbreviation">Word64</span></a>.<br/>

<br/>
</div>

<div class="doc">
The masks that are required when selecting bits during. field
    arithmetic.

</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <a name="Select32"><span class="id" title="definition">Select32</span></a> : <a class="idref" href="Verse.Verse.Types.html#constant"><span class="id" title="definition">constant</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Limb"><span class="id" title="definition">Limb</span></a> := <a class="idref" href="Verse.Verse.Nibble.html#Ox"><span class="id" title="definition">Ox</span></a> "00:00:00:00 FF:FF:FF:FF".<br/>
<span class="id" title="keyword">Definition</span> <a name="Select2"><span class="id" title="definition">Select2</span></a>  : <a class="idref" href="Verse.Verse.Types.html#constant"><span class="id" title="definition">constant</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Limb"><span class="id" title="definition">Limb</span></a> := <a class="idref" href="Verse.Verse.Nibble.html#Ox"><span class="id" title="definition">Ox</span></a> "00:00:00:00 00:00:00:03".<br/>

<br/>
</div>

<div class="doc">
<a name="lab55"></a><h3 class="section">Managing the accumulator during evaluation.</h3>


<div class="paragraph"> </div>

Although all elements in <span class="inlinecode"><span class="id" title="var">𝔽</span></span> can be reduced to the standard form that
we described above, during the evaluation of the MAC, we maintain a
slightly looser bound on the number of significant bits in <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span>. At
the start of any of the update, we maintain the invariant that
<span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a>..<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a></span> have 32-bits each as in the standard form but <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> has at
most 3 significant bits (i.e one more than that in the standard
form). This will ensure that no overflows happen when performing the
update <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a></span> <span class="inlinecode">:=</span> <span class="inlinecode">(<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.C"><span class="id" title="projection">C</span></a>)</span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a></span>. However, as a result of the update the
invariant on <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a>..<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> will be violated. We restore this with a single
carry propagation and reduction.

<div class="paragraph"> </div>

As a final step, after all the coefficients of the message polynomial
has been processed, we perform a full modular reduction.

<div class="paragraph"> </div>


</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="Internal"><span class="id" title="module">Internal</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <a name="Internal.Poly1305"><span class="id" title="section">Poly1305</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab56"></a><h1 class="section">Program variables.</h1>


<div class="paragraph"> </div>

    Let us start by parameterising over the program variables.

<div class="paragraph"> </div>

     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> : <a class="idref" href="Verse.Verse.Syntax.html#VariableT"><span class="id" title="definition">VariableT</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">progvar</span> [<span class="id" title="var">k</span>] <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
We define type aliases for some of the types that are relevant
        for poly1305. See the arithmetic section on the rationale for
        these choices. The arrays are packed representations where as
        their indices are split up into 32-bit chunks.
     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.ElemArray"><span class="id" title="definition">ElemArray</span></a> := <a class="idref" href="Verse.Verse.Types.html#Array"><span class="id" title="definition">Array</span></a> 3 <a class="idref" href="Verse.Verse.Types.Internal.html#hostE"><span class="id" title="constructor">hostE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Limb"><span class="id" title="definition">Limb</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.Array128"><span class="id" title="definition">Array128</span></a>  := <a class="idref" href="Verse.Verse.Types.html#Array"><span class="id" title="definition">Array</span></a> 2 <a class="idref" href="Verse.Verse.Types.Internal.html#hostE"><span class="id" title="constructor">hostE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Limb"><span class="id" title="definition">Limb</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.ElemIndex"><span class="id" title="definition">ElemIndex</span></a> := <a class="idref" href="Verse.Verse.Language.Utils.html#VarIndex"><span class="id" title="definition">VarIndex</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> 5 <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Limb"><span class="id" title="definition">Limb</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.RIndex"><span class="id" title="definition">RIndex</span></a>    := <a class="idref" href="Verse.Verse.Language.Utils.html#VarIndex"><span class="id" title="definition">VarIndex</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> 4 <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Limb"><span class="id" title="definition">Limb</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab57"></a><h2 class="section">Parameters.</h2>


<div class="paragraph"> </div>

       We have three functions exposed from this module.

<div class="paragraph"> </div>

        1. A poly1305 iterator that incrementally process multiples of
           blocks. This iterator is used while incrementally
           processing blocks and the entire message is not yet seen.
           The only parameters for this iterator is the array holding
           the accumulator (<span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.AArray"><span class="id" title="variable">AArray</span></a></span>), the array holding the value <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a></span>
           (<span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.RArray"><span class="id" title="variable">RArray</span></a></span>).

<div class="paragraph"> </div>

        2. A poly1305 iterator that in addition to processing of
           multiple of blocks also finalises the message hash. This is
           used where dealing with messages which are exact multiples
           of the block length. The parameters for this iterator is
           the array holding the accumulator (<span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.AArray"><span class="id" title="variable">AArray</span></a></span>), the array
           holding the value <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a></span> (<span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.RArray"><span class="id" title="variable">RArray</span></a></span>), and the array holding
           value <span class="inlinecode"><a class="idref" href="Verse.Verse.Semantics.html#Semantics.Semantics.s"><span class="id" title="variable">s</span></a></span> (<span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.SArray"><span class="id" title="variable">SArray</span></a></span>).

<div class="paragraph"> </div>

        3. A poly1305 last block processing function. This function
           should be used only for processing messages that have an
           incomplete last block. This function however expects its
           input buffer to be the size of a single block which in
           addition is appropriately padded.  The parameters for this
           function is the message buffer <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LastBlock"><span class="id" title="variable">LastBlock</span></a></span> having size
           at-least 16-bytes holding the padded message, the array
           holding the accumulator (<span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.AArray"><span class="id" title="variable">AArray</span></a></span>), the array holding the
           value <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a></span> (<span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.RArray"><span class="id" title="variable">RArray</span></a></span>), and the array holding value <span class="inlinecode"><a class="idref" href="Verse.Verse.Semantics.html#Semantics.Semantics.s"><span class="id" title="variable">s</span></a></span>
           (<span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.SArray"><span class="id" title="variable">SArray</span></a></span>).

<div class="paragraph"> </div>

        4. The clamping function for generating valid poly1305 keys
           <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a></span>.

<div class="paragraph"> </div>

        They have slightly different parameters and hence we have
        different names for the list.

<div class="paragraph"> </div>

     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="Internal.Poly1305.LastBlock"><span class="id" title="variable">LastBlock</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Block"><span class="id" title="definition">Block</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="Internal.Poly1305.AArray"><span class="id" title="variable">AArray</span></a>    : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.ElemArray"><span class="id" title="definition">ElemArray</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="Internal.Poly1305.RArray"><span class="id" title="variable">RArray</span></a>    : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Array128"><span class="id" title="definition">Array128</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="Internal.Poly1305.SArray"><span class="id" title="variable">SArray</span></a>    : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Array128"><span class="id" title="definition">Array128</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.paramsIncremental"><span class="id" title="definition">paramsIncremental</span></a> : <a class="idref" href="Verse.Verse.Syntax.html#Declaration"><span class="id" title="abbreviation">Declaration</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">[</span></a><a class="idref" href="Verse.Verse.Syntax.html#Var"><span class="id" title="definition">Var</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.AArray"><span class="id" title="variable">AArray</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.Syntax.html#Var"><span class="id" title="definition">Var</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.RArray"><span class="id" title="variable">RArray</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.paramsBlockMac"><span class="id" title="definition">paramsBlockMac</span></a>    : <a class="idref" href="Verse.Verse.Syntax.html#Declaration"><span class="id" title="abbreviation">Declaration</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">[</span></a><a class="idref" href="Verse.Verse.Syntax.html#Var"><span class="id" title="definition">Var</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.AArray"><span class="id" title="variable">AArray</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.Syntax.html#Var"><span class="id" title="definition">Var</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.RArray"><span class="id" title="variable">RArray</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.Syntax.html#Var"><span class="id" title="definition">Var</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.SArray"><span class="id" title="variable">SArray</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.paramsPartialMac"><span class="id" title="definition">paramsPartialMac</span></a>   : <a class="idref" href="Verse.Verse.Syntax.html#Declaration"><span class="id" title="abbreviation">Declaration</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">[</span></a><a class="idref" href="Verse.Verse.Syntax.html#Var"><span class="id" title="definition">Var</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LastBlock"><span class="id" title="variable">LastBlock</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.Syntax.html#Var"><span class="id" title="definition">Var</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.AArray"><span class="id" title="variable">AArray</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.Syntax.html#Var"><span class="id" title="definition">Var</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.RArray"><span class="id" title="variable">RArray</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.Syntax.html#Var"><span class="id" title="definition">Var</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.SArray"><span class="id" title="variable">SArray</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.paramsClamp"><span class="id" title="definition">paramsClamp</span></a>       : <a class="idref" href="Verse.Verse.Syntax.html#Declaration"><span class="id" title="abbreviation">Declaration</span></a> := <a class="idref" href="Verse.Verse.Syntax.html#Empty"><span class="id" title="definition">Empty</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab58"></a><h2 class="section">Registers.</h2>


<div class="paragraph"> </div>

        Except for the clamping function all the other functions have
        similar register usage. We keep a working copy of the
        accumulator in the registers <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a>,...,<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span>, the poly1305
        parameter <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a></span> in the registers <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a>,..,<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r3"><span class="id" title="variable">r<sub>3</sub></span></a></span>. We also need
        registers <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p1"><span class="id" title="variable">p<sub>1</sub></span></a>,..,<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p4"><span class="id" title="variable">p<sub>4</sub></span></a></span> to help us compute the product
        <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a>×<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a></span>. Besides we need some temporary registers <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a></span> and <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a></span>.
        We also define register caches <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a></span> and <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a></span> for ease of coding
        with these registers.

<div class="paragraph"> </div>

        The clamping function only needs the temporary variable <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a></span>
        as its register

<div class="paragraph"> </div>

     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variables</span> <a name="Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a> <a name="Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a> <a name="Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a> <a name="Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a> <a name="Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a> : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Limb"><span class="id" title="definition">Limb</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variables</span> <a name="Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a> <a name="Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a> <a name="Internal.Poly1305.r2"><span class="id" title="variable">r<sub>2</sub></span></a> <a name="Internal.Poly1305.r3"><span class="id" title="variable">r<sub>3</sub></span></a>    : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Limb"><span class="id" title="definition">Limb</span></a>.<br/>
</div>

<div class="doc">
The limbs that capture the result of product 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="Internal.Poly1305.p1"><span class="id" title="variable">p<sub>1</sub></span></a> <a name="Internal.Poly1305.p2"><span class="id" title="variable">p<sub>2</sub></span></a> <a name="Internal.Poly1305.p3"><span class="id" title="variable">p<sub>3</sub></span></a> <a name="Internal.Poly1305.p4"><span class="id" title="variable">p<sub>4</sub></span></a> : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Limb"><span class="id" title="definition">Limb</span></a>.<br/>

<br/>
</div>

<div class="doc">
Temporary variables that is used often 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a name="Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a> : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Limb"><span class="id" title="definition">Limb</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.register"><span class="id" title="definition">register</span></a> : <a class="idref" href="Verse.Verse.Syntax.html#Declaration"><span class="id" title="abbreviation">Declaration</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.Vector.html#map"><span class="id" title="definition">Vector.map</span></a> <a class="idref" href="Verse.Verse.Syntax.html#Var"><span class="id" title="definition">Var</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r3"><span class="id" title="variable">r<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p1"><span class="id" title="variable">p<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p2"><span class="id" title="variable">p<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p3"><span class="id" title="variable">p<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p4"><span class="id" title="variable">p<sub>4</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">]</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.A"><span class="id" title="definition">A</span></a> : <a class="idref" href="Verse.Verse.Language.Utils.html#VarIndex"><span class="id" title="definition">VarIndex</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> 5 <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Limb"><span class="id" title="definition">Limb</span></a> := <a class="idref" href="Verse.Verse.Language.Utils.html#varIndex"><span class="id" title="definition">varIndex</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">[</span></a><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">]</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.R"><span class="id" title="definition">R</span></a> : <a class="idref" href="Verse.Verse.Language.Utils.html#VarIndex"><span class="id" title="definition">VarIndex</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> 4 <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Limb"><span class="id" title="definition">Limb</span></a> := <a class="idref" href="Verse.Verse.Language.Utils.html#varIndex"><span class="id" title="definition">varIndex</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">[</span></a><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r3"><span class="id" title="variable">r<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">]</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <a name="Internal.Poly1305.LoadStore64"><span class="id" title="section">LoadStore64</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="Internal.Poly1305.LoadStore64.bound"><span class="id" title="variable">bound</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="Internal.Poly1305.LoadStore64.e"><span class="id" title="variable">e</span></a>     : <a class="idref" href="Verse.Verse.Types.Internal.html#endian"><span class="id" title="inductive">endian</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="Internal.Poly1305.LoadStore64.Arr"><span class="id" title="variable">Arr</span></a>   : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> (<a class="idref" href="Verse.Verse.Types.html#Array"><span class="id" title="definition">Array</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.bound"><span class="id" title="variable">bound</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.e"><span class="id" title="variable">e</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Limb"><span class="id" title="definition">Limb</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="Internal.Poly1305.LoadStore64.i"><span class="id" title="variable">i</span></a>     : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="Internal.Poly1305.LoadStore64.x0"><span class="id" title="variable">x0</span></a> <a name="Internal.Poly1305.LoadStore64.x1"><span class="id" title="variable">x1</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Limb"><span class="id" title="definition">Limb</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="Internal.Poly1305.LoadStore64.bpf"><span class="id" title="variable">bpf</span></a>   : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#989c98e7ddd65d5bf37c334ff2076de8"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.bound"><span class="id" title="variable">bound</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.Load64"><span class="id" title="definition">Load64</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">verse</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.x1"><span class="id" title="variable">x1</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e5f90bd3e877d9e98ec926ce1508c97d"><span class="id" title="notation">::=</span></a>  <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.Arr"><span class="id" title="variable">Arr</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#6990918f84290fa34850a4b77307cea9"><span class="id" title="notation">[-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.i"><span class="id" title="variable">i</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#6990918f84290fa34850a4b77307cea9"><span class="id" title="notation">-]</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.x0"><span class="id" title="variable">x0</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#3d9d72ad686ce03b433890d080b1de31"><span class="id" title="notation">::=</span></a>  <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.x1"><span class="id" title="variable">x1</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#3d9d72ad686ce03b433890d080b1de31"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Select32"><span class="id" title="definition">Select32</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.x1"><span class="id" title="variable">x1</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#453a94a99aa4dca083c53dd626a5724c"><span class="id" title="notation">::=&gt;&gt;</span></a> 32<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>%<span class="id" title="var">list</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.Mov64"><span class="id" title="definition">Mov64</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">verse</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.x1"><span class="id" title="variable">x1</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#9ca23d6fe28242ff4435de96956f9dc9"><span class="id" title="notation">::=&lt;&lt;</span></a> 32<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.x1"><span class="id" title="variable">x1</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#b56946c920ec4d6ffcf5c1ff7ca19d58"><span class="id" title="notation">::=|</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.x0"><span class="id" title="variable">x0</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Pretty.html#91540c87ae8fa322a43bd88414257ccb"><span class="id" title="notation">MOVE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.x1"><span class="id" title="variable">x1</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#91540c87ae8fa322a43bd88414257ccb"><span class="id" title="notation">TO</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.Arr"><span class="id" title="variable">Arr</span></a><a class="idref" href="Verse.Verse.Language.Pretty.html#91540c87ae8fa322a43bd88414257ccb"><span class="id" title="notation">[-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.i"><span class="id" title="variable">i</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#91540c87ae8fa322a43bd88414257ccb"><span class="id" title="notation">-]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>%<span class="id" title="var">list</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">End</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64"><span class="id" title="section">LoadStore64</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Load64"><span class="id" title="definition">Load64</span></a> [<span class="id" title="var">bound</span> <span class="id" title="var">e</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Mov64"><span class="id" title="definition">Mov64</span></a> [<span class="id" title="var">bound</span> <span class="id" title="var">e</span>].<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.LoadA"><span class="id" title="definition">LoadA</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">verse</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Load64"><span class="id" title="definition">Load64</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.AArray"><span class="id" title="variable">AArray</span></a> 0 <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Load64"><span class="id" title="definition">Load64</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.AArray"><span class="id" title="variable">AArray</span></a> 1 <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e5f90bd3e877d9e98ec926ce1508c97d"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.AArray"><span class="id" title="variable">AArray</span></a><a class="idref" href="Verse.Verse.Language.Pretty.html#6990918f84290fa34850a4b77307cea9"><span class="id" title="notation">[-</span></a> 2 <a class="idref" href="Verse.Verse.Language.Pretty.html#6990918f84290fa34850a4b77307cea9"><span class="id" title="notation">-]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">list</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.LoadR"><span class="id" title="definition">LoadR</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">verse</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Load64"><span class="id" title="definition">Load64</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.RArray"><span class="id" title="variable">RArray</span></a> 0 <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Load64"><span class="id" title="definition">Load64</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.RArray"><span class="id" title="variable">RArray</span></a> 1 <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r<sub>2</sub></span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r3"><span class="id" title="variable">r<sub>3</sub></span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">list</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.MovA"><span class="id" title="definition">MovA</span></a>  : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">verse</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Mov64"><span class="id" title="definition">Mov64</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.AArray"><span class="id" title="variable">AArray</span></a> 0 <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Mov64"><span class="id" title="definition">Mov64</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.AArray"><span class="id" title="variable">AArray</span></a> 1 <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#91540c87ae8fa322a43bd88414257ccb"><span class="id" title="notation">MOVE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#91540c87ae8fa322a43bd88414257ccb"><span class="id" title="notation">TO</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.AArray"><span class="id" title="variable">AArray</span></a><a class="idref" href="Verse.Verse.Language.Pretty.html#91540c87ae8fa322a43bd88414257ccb"><span class="id" title="notation">[-</span></a> 2 <a class="idref" href="Verse.Verse.Language.Pretty.html#91540c87ae8fa322a43bd88414257ccb"><span class="id" title="notation">-]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">list</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab59"></a><h1 class="section">The Horner's step as subroutines.</h1>


<div class="paragraph"> </div>

        The main step in the poly1305 computation is the update of the
        accumulator using the <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a></span> <span class="inlinecode">:=</span> <span class="inlinecode">(<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.C"><span class="id" title="projection">C</span></a>)</span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a></span> step where <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.C"><span class="id" title="projection">C</span></a></span> is the
        current block treated as a polynomial coefficient. We break up
        this step into three parts.

<div class="paragraph"> </div>

<ul class="doclist">
<li> Adding the coefficient

<div class="paragraph"> </div>


</li>
<li> Multiplying by R

<div class="paragraph"> </div>


</li>
<li> Propagating carry and reduction mod <span class="inlinecode"><span class="id" title="var">2<sup>130</sup></span></span> <span class="inlinecode">-</span> <span class="inlinecode">5</span>.

</li>
</ul>

<div class="paragraph"> </div>

     
<div class="paragraph"> </div>

<a name="lab60"></a><h2 class="section">Adding 128-bit to accumulator.</h2>


<div class="paragraph"> </div>

       There are two variants of this function. The first variant just
       adds the block as 128-bit element of the field <span class="inlinecode"><span class="id" title="var">𝔽</span></span>. The next
       also increments the 129th bit. The former can be used when
       handling the last partial block (padded appropriately) where as
       the latter is used for complete blocks. No carry propagation is
       done by these code.

<div class="paragraph"> </div>

     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.Add128"><span class="id" title="definition">Add128</span></a> {<span class="id" title="var">e</span> : <a class="idref" href="Verse.Verse.Types.Internal.html#endian"><span class="id" title="inductive">endian</span></a>}(<span class="id" title="var">blk</span> : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> (<a class="idref" href="Verse.Verse.Types.html#Array"><span class="id" title="definition">Array</span></a> 2 <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="Verse.Verse.Types.html#Word64"><span class="id" title="abbreviation">Word64</span></a>)) : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">verse</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Load64"><span class="id" title="definition">Load64</span></a> <span class="id" title="var">blk</span> 0 <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a>  <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a>  <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Load64"><span class="id" title="definition">Load64</span></a> <span class="id" title="var">blk</span> 1 <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">list</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.AddFullBlock"><span class="id" title="definition">AddFullBlock</span></a> (<span class="id" title="var">blk</span> : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Block"><span class="id" title="definition">Block</span></a>) : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Add128"><span class="id" title="definition">Add128</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#blk"><span class="id" title="variable">blk</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4f32b7f62631ac1618784602f5eace66"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a>%<span class="id" title="var">list</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab61"></a><h2 class="section">Computing <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a></span> <span class="inlinecode">:=</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a></span></h2>


<div class="paragraph"> </div>

        We need to multiply the quantities

<div class="paragraph"> </div>

        <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>32</sup></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>64</sup></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>96</sup></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> <span class="inlinecode"><span class="id" title="var">2<sup>128</sup></span></span>
        with

<div class="paragraph"> </div>

        <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>32</sup></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r<sub>2</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>64</sup></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r3"><span class="id" title="variable">r<sub>3</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>96</sup></span></span> <span class="inlinecode"></span>

<div class="paragraph"> </div>

        There is a total of 20-terms of the form <span class="inlinecode"><span class="id" title="var">a<sub>i</sub></span></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">r<sub>j</sub></span></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>32(i+j)</sup></span></span>
        <span class="inlinecode"></span>. When (i + j &gt;= 4), <span class="inlinecode"><span class="id" title="var">2<sup>32(i+j)</sup></span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">2<sup>128</sup></span></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>32(i+j - 4)</sup></span></span> together
        with an additional <span class="inlinecode"><span class="id" title="var">2<sup>2</sup></span></span> from <span class="inlinecode"><span class="id" title="var">r<sub>j</sub></span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">r<sub>j</sub></span>/4</span> <span class="inlinecode">×</span> <span class="inlinecode">4</span> gives a term of
        the kind <span class="inlinecode"><span class="id" title="var">2<sup>130</sup></span></span>. However in the field <span class="inlinecode"><span class="id" title="var">𝔽</span></span>, <span class="inlinecode"><span class="id" title="var">2<sup>130</sup></span></span> <span class="inlinecode">=</span> <span class="inlinecode">5</span> and
        hence the ij-th term in the product gives <span class="inlinecode">5</span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">a<sub>i</sub></span></span> <span class="inlinecode">×</span> <span class="inlinecode">(<span class="id" title="var">r<sub>j</sub></span>/4)</span>
        <span class="inlinecode"><span class="id" title="var">2<sup>32(i+j - 4)</sup></span></span>. Since the two lower order bits of <span class="inlinecode"><span class="id" title="var">r<sub>j</sub></span></span> are zeros
        (except when j = 0), we can shift them without really worrying
        about loosing bits. The product is given by

<div class="paragraph"> </div>

        <span class="inlinecode"><a class="idref" href="Verse.Verse.Arch.html#p"><span class="id" title="variable">p</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">p<sub>0</sub></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p1"><span class="id" title="variable">p<sub>1</sub></span></a></span> <span class="inlinecode"><span class="id" title="var">2<sup>32</sup></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p2"><span class="id" title="variable">p<sub>2</sub></span></a></span> <span class="inlinecode"><span class="id" title="var">2<sup>64</sup></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p3"><span class="id" title="variable">p<sub>3</sub></span></a></span> <span class="inlinecode"><span class="id" title="var">2<sup>96</sup></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p4"><span class="id" title="variable">p<sub>4</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>128</sup></span></span>

<div class="paragraph"> </div>

        where

<div class="paragraph"> </div>

        <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p4"><span class="id" title="variable">p<sub>4</sub></span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a></span> <span class="inlinecode">&amp;</span> <span class="inlinecode">3</span>

<div class="paragraph"> </div>

        <span class="inlinecode"><span class="id" title="var">p<sub>0</sub></span></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">r′<sub>3</sub></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">r′<sub>2</sub></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">r′<sub>1</sub></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">r′<sub>0</sub></span></span> <span class="inlinecode"></span>

<div class="paragraph"> </div>

        <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p1"><span class="id" title="variable">p<sub>1</sub></span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">r′<sub>3</sub></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">r′<sub>2</sub></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">r′<sub>1</sub></span></span> <span class="inlinecode"></span>

<div class="paragraph"> </div>

        <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p2"><span class="id" title="variable">p<sub>2</sub></span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r<sub>2</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">r′<sub>3</sub></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">r′<sub>2</sub></span></span> <span class="inlinecode"></span>

<div class="paragraph"> </div>

        <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p3"><span class="id" title="variable">p<sub>3</sub></span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r3"><span class="id" title="variable">r<sub>3</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r<sub>2</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">r′<sub>3</sub></span></span> <span class="inlinecode"></span>

<div class="paragraph"> </div>

        <span class="inlinecode"><span class="id" title="var">r′<sub>i</sub></span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">r<sub>i</sub></span></span> <span class="inlinecode">&gt;&gt;</span> <span class="inlinecode">2</span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">r<sub>i</sub></span>/4</span>. Note that we do not loose any of the
        bits of <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a></span>,<span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r<sub>2</sub></span></a></span>, and <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r3"><span class="id" title="variable">r<sub>3</sub></span></a></span>. The two bits lost from <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a></span> is
        accounted for in <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p4"><span class="id" title="variable">p<sub>4</sub></span></a></span>.

<div class="paragraph"> </div>

        We now give the function for multiplying the accumulator with
        <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a></span>.  The expected input is such that each <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a>..<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a></span> should be
        at-most 33-bit (1 additional bit that comes from adding the
        coefficient of the polynomial) and <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> is at-most 4 bits.

<div class="paragraph"> </div>

        A note on the variables

<div class="paragraph"> </div>

        We have variables for p1,p2,p3 and p4 only. The value of p0 is
        computed in a0 directly because we can arrange the operations
        such that a0 is no more used when we want to compute p0.

<div class="paragraph"> </div>

     
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.MulR"><span class="id" title="definition">MulR</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
Summing up terms of the kind <span class="inlinecode"><span class="id" title="var">a<sub>i</sub></span></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">r<sub>j</sub></span></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>32(i+j)</sup></span></span> for <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.i"><span class="id" title="variable">i</span></a>+<span class="id" title="var">j</span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode">4</span> 
<div class="paragraph"> </div>

<a name="lab62"></a><h3 class="section"><span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p3"><span class="id" title="variable">p<sub>3</sub></span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r3"><span class="id" title="variable">r<sub>3</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r<sub>2</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a></span></h3>

</div>
<div class="code">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p3"><span class="id" title="variable">p<sub>3</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r3"><span class="id" title="variable">r<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p3"><span class="id" title="variable">p<sub>3</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p3"><span class="id" title="variable">p<sub>3</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p3"><span class="id" title="variable">p<sub>3</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
<a name="lab63"></a><h3 class="section"><span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p2"><span class="id" title="variable">p<sub>2</sub></span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r<sub>2</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a></span></h3>

</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p2"><span class="id" title="variable">p<sub>2</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p2"><span class="id" title="variable">p<sub>2</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p2"><span class="id" title="variable">p<sub>2</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
<a name="lab64"></a><h3 class="section"><span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p1"><span class="id" title="variable">p<sub>1</sub></span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a></span></h3>

</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p1"><span class="id" title="variable">p<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p1"><span class="id" title="variable">p<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
<a name="lab65"></a><h3 class="section"><span class="inlinecode"><span class="id" title="var">p<sub>0</sub></span></span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a></span> <span class="inlinecode">;</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a></span> <span class="inlinecode">:=</span> <span class="inlinecode"><span class="id" title="var">p<sub>0</sub></span></span></h3>

</div>
<div class="code">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#0415237f7e7d2ed19900c5649fea2b2a"><span class="id" title="notation">::=*</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
Summing up terms of the kind <span class="inlinecode"><span class="id" title="var">a<sub>i</sub></span></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">r<sub>j</sub></span></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>32(i+j)</sup></span></span> for
              <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LoadStore64.i"><span class="id" title="variable">i</span></a>+<span class="id" title="var">j</span></span> <span class="inlinecode">≥</span> <span class="inlinecode">4</span>.
           
<div class="paragraph"> </div>

<a name="lab66"></a><h3 class="section">Terms of the kind <span class="inlinecode"><span class="id" title="var">a<sub>i</sub></span></span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r3"><span class="id" title="variable">r<sub>3</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>32(i+j)</sup></span></span>.</h3>


<div class="paragraph"> </div>

              At this point the product component <span class="inlinecode"><span class="id" title="var">p<sub>0</sub></span></span> is already in
              <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a></span>. Also we do not need <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a></span> after the contribution of
              <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r3"><span class="id" title="variable">r<sub>3</sub></span></a></span> to <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a></span> has been computed. So we update <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a></span>
              directly and the product component <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p1"><span class="id" title="variable">p<sub>1</sub></span></a></span> is now in <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a></span>.

<div class="paragraph"> </div>

           
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#277babd6c87c6d6fcd2bb26bfa0b5708"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r3"><span class="id" title="variable">r<sub>3</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#277babd6c87c6d6fcd2bb26bfa0b5708"><span class="id" title="notation">&gt;&gt;</span></a> 2<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r3"><span class="id" title="variable">r<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#a23f2aca9935b18f2f807af2e73f752e"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p1"><span class="id" title="variable">p<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#a23f2aca9935b18f2f807af2e73f752e"><span class="id" title="notation">+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p2"><span class="id" title="variable">p<sub>2</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p3"><span class="id" title="variable">p<sub>3</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
<a name="lab67"></a><h3 class="section">Terms of the kind <span class="inlinecode"><span class="id" title="var">a<sub>i</sub></span></span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r<sub>2</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>32(i+j)</sup></span></span></h3>


<div class="paragraph"> </div>

              At this point the product components <span class="inlinecode"><span class="id" title="var">p<sub>0</sub></span></span> and <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p1"><span class="id" title="variable">p<sub>1</sub></span></a></span> are
              already in <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a></span> and <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a></span>. As before we will free up <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a></span>
              hence update <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a></span> directly.

<div class="paragraph"> </div>

           
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#277babd6c87c6d6fcd2bb26bfa0b5708"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r<sub>2</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#277babd6c87c6d6fcd2bb26bfa0b5708"><span class="id" title="notation">&gt;&gt;</span></a> 2<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#a23f2aca9935b18f2f807af2e73f752e"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p2"><span class="id" title="variable">p<sub>2</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#a23f2aca9935b18f2f807af2e73f752e"><span class="id" title="notation">+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
<a name="lab68"></a><h3 class="section">Terms of the kind <span class="inlinecode"><span class="id" title="var">a<sub>i</sub></span></span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>32(i+j)</sup></span></span>.</h3>

</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#277babd6c87c6d6fcd2bb26bfa0b5708"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#277babd6c87c6d6fcd2bb26bfa0b5708"><span class="id" title="notation">&gt;&gt;</span></a> 2<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
<a name="lab69"></a><h3 class="section">Terms of the kind <span class="inlinecode"><span class="id" title="var">a<sub>i</sub></span></span> <span class="inlinecode">×</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">2<sup>32(i+j)</sup></span></span></h3>

</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#277babd6c87c6d6fcd2bb26bfa0b5708"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#277babd6c87c6d6fcd2bb26bfa0b5708"><span class="id" title="notation">&gt;&gt;</span></a> 2<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#0415237f7e7d2ed19900c5649fea2b2a"><span class="id" title="notation">::=*</span></a> 5<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T1"><span class="id" title="variable">T<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>

<div class="doc">
<a name="lab70"></a><h3 class="section">Setting <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a></span> and <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span>.</h3>


<div class="paragraph"> </div>

              The two bits that we lost when shifting <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a></span> contributes
              to <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> where as <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a></span> is just <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p3"><span class="id" title="variable">p<sub>3</sub></span></a></span> at this point.  
</div>
<div class="code">
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e5f90bd3e877d9e98ec926ce1508c97d"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p3"><span class="id" title="variable">p<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p4"><span class="id" title="variable">p<sub>4</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#3d9d72ad686ce03b433890d080b1de31"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#3d9d72ad686ce03b433890d080b1de31"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Select2"><span class="id" title="definition">Select2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#0415237f7e7d2ed19900c5649fea2b2a"><span class="id" title="notation">::=*</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.p4"><span class="id" title="variable">p<sub>4</sub></span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>%<span class="id" title="var">list</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab71"></a><h1 class="section">Controlling overflows.</h1>


<div class="paragraph"> </div>

    The sizes of the registers and the constants have been so chosen
    that a single Horner step does not lead to any overflows. As
    described in above, we can successfully compute the next step if
    and only if maintain the invariant that the registers <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a>..<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a></span>
    have 32-bits each and <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> has 3 bits. This we maintain by
    performing carry propagation and reduction modulo <span class="inlinecode"><span class="id" title="var">2<sup>130</sup></span></span> <span class="inlinecode">-</span> <span class="inlinecode">5</span>.

<div class="paragraph"> </div>

     
<div class="paragraph"> </div>

<a name="lab72"></a><h2 class="section">Propagating carries and Reductions.</h2>


<div class="paragraph"> </div>

        An element of <span class="inlinecode"><span class="id" title="var">𝔽</span></span> can be stored with 32-bits each in
        registers <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a>..<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a></span> and the remaining 2 bits in <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span>. After
        arithmetic, we often need to propagate carries. Also the bits
        beyond the least two bits in <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> contribute a factor of
        <span class="inlinecode"><span class="id" title="var">2<sup>130</sup></span></span>. In the field <span class="inlinecode"><span class="id" title="var">𝔽</span></span>, <span class="inlinecode"><span class="id" title="var">2<sup>130</sup></span></span> <span class="inlinecode">=</span> <span class="inlinecode">5</span> and hence bits
        beyond the least two bits in <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> can be seen as a wrapped
        "carry" to <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a></span> with a multiplicative factor of 5. We first
        give helper functions to perform these propagation.

<div class="paragraph"> </div>

     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.PropagateIth"><span class="id" title="definition">PropagateIth</span></a> (<span class="id" title="var">i</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)(<span class="id" title="var">pf</span> : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#989c98e7ddd65d5bf37c334ff2076de8"><span class="id" title="notation">&lt;</span></a> 4) : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">verse</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#277babd6c87c6d6fcd2bb26bfa0b5708"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.A"><span class="id" title="definition">A</span></a> <span class="id" title="var">i</span> <span class="id" title="var">_</span> <a class="idref" href="Verse.Verse.Language.Pretty.html#277babd6c87c6d6fcd2bb26bfa0b5708"><span class="id" title="notation">&gt;&gt;</span></a> 32<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.A"><span class="id" title="definition">A</span></a> <span class="id" title="var">i</span>        <span class="id" title="var">_</span> <a class="idref" href="Verse.Verse.Language.Pretty.html#dc3ddc621107d5976c8e43171a9d7186"><span class="id" title="notation">::=&amp;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Select32"><span class="id" title="definition">Select32</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.A"><span class="id" title="definition">A</span></a> (1 <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <span class="id" title="var">i</span>)  <span class="id" title="var">_</span> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>%<span class="id" title="var">list</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.Propagate"><span class="id" title="definition">Propagate</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> := <a class="idref" href="Verse.Verse.Language.Utils.html#iterate"><span class="id" title="definition">iterate</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.PropagateIth"><span class="id" title="definition">PropagateIth</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.Wrap"><span class="id" title="definition">Wrap</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#277babd6c87c6d6fcd2bb26bfa0b5708"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#277babd6c87c6d6fcd2bb26bfa0b5708"><span class="id" title="notation">&gt;&gt;</span></a> 2<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#dc3ddc621107d5976c8e43171a9d7186"><span class="id" title="notation">::=&amp;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Select2"><span class="id" title="definition">Select2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#0415237f7e7d2ed19900c5649fea2b2a"><span class="id" title="notation">::=*</span></a> 5 <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>%<span class="id" title="var">list</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab73"></a><h2 class="section">Adjusting <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a>,..,<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> to maintain the invariant.</h2>


<div class="paragraph"> </div>

        After multiplication of <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.R"><span class="id" title="definition">R</span></a></span> to the accumulator using the
        routine <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.MulR"><span class="id" title="definition">MulR</span></a></span> the number of bits in all the registers
        <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a>..<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> nearly doubles.  With a reduction and a carry
        propagation we can maintain this invariant. However, this
        needs to be carefully done to avoid problems.

<div class="paragraph"> </div>

        Propagating carries from <span class="inlinecode"><span class="id" title="var">a<sub>i</sub></span></span> to <span class="inlinecode"><span class="id" title="var">a<sub>i+1</sub></span></span> makes <span class="inlinecode"><span class="id" title="var">a<sub>i</sub></span></span> 32-bits.
        However, as described above, the bits beyond the least two
        bits of <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> wrap back to <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a></span> and results in a reduction
        modulo <span class="inlinecode"><span class="id" title="var">2<sup>130</sup></span></span> <span class="inlinecode">-</span> <span class="inlinecode">5</span>. To get the bit pattern as described
        above, we should start from <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a></span> so that when we terminate,
        all the <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a>..<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a></span> will have 32-bits each and <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span> 3-bits (one
        more than the ideal 2-bits).

<div class="paragraph"> </div>

     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.AdjustBits"><span class="id" title="definition">AdjustBits</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">verse</span>  (<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.PropagateIth"><span class="id" title="definition">PropagateIth</span></a> 3 <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Wrap"><span class="id" title="definition">Wrap</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Propagate"><span class="id" title="definition">Propagate</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab74"></a><h2 class="section">Final modular reduction.</h2>


<div class="paragraph"> </div>

        Let <span class="inlinecode"><a class="idref" href="Verse.Verse.Arch.html#p"><span class="id" title="variable">p</span></a></span> be the prime <span class="inlinecode"><span class="id" title="var">2<sup>130</sup></span></span> <span class="inlinecode">-</span> <span class="inlinecode">5</span>, and let <span class="inlinecode"><span class="id" title="var">α</span></span> be such
        that <span class="inlinecode">0</span> <span class="inlinecode">≤</span> <span class="inlinecode"><span class="id" title="var">α</span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode">2<a class="idref" href="Verse.Verse.Arch.html#p"><span class="id" title="variable">p</span></a></span>.  We would need to subtract at most a
        <span class="inlinecode"><a class="idref" href="Verse.Verse.Arch.html#p"><span class="id" title="variable">p</span></a></span>. Let <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.blake2.c.portable.html#u"><span class="id" title="variable">u</span></a></span> denote 131-st bit of <span class="inlinecode"><span class="id" title="var">α</span></span> <span class="inlinecode">+</span> <span class="inlinecode">5</span> then <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.blake2.c.portable.html#u"><span class="id" title="variable">u</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode">1</span> if
        and only if <span class="inlinecode"><span class="id" title="var">α</span></span> <span class="inlinecode">&gt;</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.Arch.html#p"><span class="id" title="variable">p</span></a></span>. Furthermore, if we consider <span class="inlinecode"><span class="id" title="keyword">β</span></span> <span class="inlinecode">=</span>
        <span class="inlinecode"><span class="id" title="var">α</span></span> <span class="inlinecode">+</span> <span class="inlinecode">5<a class="idref" href="Verse.Verse.CryptoLib.blake2.c.portable.html#u"><span class="id" title="variable">u</span></a></span> <span class="inlinecode"><span class="id" title="var">mod</span></span> <span class="inlinecode"><span class="id" title="var">2<sup>130</sup></span></span>, i.e. <span class="inlinecode"><span class="id" title="keyword">β</span></span> is <span class="inlinecode"><span class="id" title="var">α</span></span> <span class="inlinecode">+</span> <span class="inlinecode">5</span> with 131-st
        bit and higher bits dropped. Then we have <span class="inlinecode"><span class="id" title="keyword">β</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">α</span></span> <span class="inlinecode"><span class="id" title="var">mod</span></span> <span class="inlinecode"><a class="idref" href="Verse.Verse.Arch.html#p"><span class="id" title="variable">p</span></a></span>
        and that <span class="inlinecode">0</span> <span class="inlinecode">≤</span> <span class="inlinecode"><span class="id" title="keyword">β</span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.Arch.html#p"><span class="id" title="variable">p</span></a></span>. This is the representation we are
        looking for.

<div class="paragraph"> </div>

        The proof is as follows.

<div class="paragraph"> </div>

        1. Note that if <span class="inlinecode"><span class="id" title="var">α</span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.Arch.html#p"><span class="id" title="variable">p</span></a></span> then <span class="inlinecode"><span class="id" title="var">α</span></span> <span class="inlinecode">+</span> <span class="inlinecode">5</span> <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">2<sup>130</sup></span></span> and
           hence the 131-st bit is zero. Hence <span class="inlinecode"><span class="id" title="var">α</span></span> <span class="inlinecode">+</span> <span class="inlinecode">5</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.blake2.c.portable.html#u"><span class="id" title="variable">u</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">α</span></span>
           which is indeed the desired one.

<div class="paragraph"> </div>

        2. If <span class="inlinecode"><a class="idref" href="Verse.Verse.Arch.html#p"><span class="id" title="variable">p</span></a></span> <span class="inlinecode">≤</span> <span class="inlinecode"><span class="id" title="var">α</span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode">2<a class="idref" href="Verse.Verse.Arch.html#p"><span class="id" title="variable">p</span></a></span> then <span class="inlinecode"><span class="id" title="var">2<sup>130</sup></span></span> <span class="inlinecode">≤</span> <span class="inlinecode"><span class="id" title="var">α</span></span> <span class="inlinecode">+</span> <span class="inlinecode">5</span> <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">2<sup>131</sup></span></span> <span class="inlinecode">-</span>
           <span class="inlinecode">5</span>. Hence the bits starting from 131 is exactly 1. In this
           case <span class="inlinecode"><span class="id" title="var">α</span></span> <span class="inlinecode">+</span> <span class="inlinecode">5</span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="keyword">β</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">2<sup>130</sup></span></span> and hence <span class="inlinecode"><span class="id" title="var">α</span></span> <span class="inlinecode">-</span> <span class="inlinecode"><span class="id" title="var">2<sup>130</sup></span></span>
           <span class="inlinecode">+</span> <span class="inlinecode">5</span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="keyword">β</span></span>, which is what we want.

<div class="paragraph"> </div>

     The function below computes the desired reduction amount <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.blake2.c.portable.html#u"><span class="id" title="variable">u</span></a></span>.

<div class="paragraph"> </div>

     
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span>  <a name="Internal.ReductionAmount"><span class="id" title="definition">ReductionAmount</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#a23f2aca9935b18f2f807af2e73f752e"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#a23f2aca9935b18f2f807af2e73f752e"><span class="id" title="notation">+</span></a> 5<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#453a94a99aa4dca083c53dd626a5724c"><span class="id" title="notation">::=&gt;&gt;</span></a> 32<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a1"><span class="id" title="variable">a<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#453a94a99aa4dca083c53dd626a5724c"><span class="id" title="notation">::=&gt;&gt;</span></a> 32<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a2"><span class="id" title="variable">a<sub>2</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#453a94a99aa4dca083c53dd626a5724c"><span class="id" title="notation">::=&gt;&gt;</span></a> 32<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a3"><span class="id" title="variable">a<sub>3</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#453a94a99aa4dca083c53dd626a5724c"><span class="id" title="notation">::=&gt;&gt;</span></a> 32<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#453a94a99aa4dca083c53dd626a5724c"><span class="id" title="notation">::=&gt;&gt;</span></a> 2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>%<span class="id" title="var">list</span>.<br/>

<br/>
</div>

<div class="doc">
Consider the number stored in the accumulator registers
         <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a>..<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a4"><span class="id" title="variable">a<sub>4</sub></span></a></span>. We assume that the value that we have is the value
         available at the end of an update. As a result the value
         <span class="inlinecode"><span class="id" title="var">α</span></span> inside the accumulator can at best be upper bounded
         as <span class="inlinecode"><span class="id" title="var">α</span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">2<sup>131</sup></span></span> <span class="inlinecode">-</span> <span class="inlinecode">1</span>. The upper bound here is slightly
         more than <span class="inlinecode">2<a class="idref" href="Verse.Verse.Arch.html#p"><span class="id" title="variable">p</span></a></span> however a single <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Wrap"><span class="id" title="definition">Wrap</span></a></span> step should take care.
         We can then do the full reduction as described above. We can
         optimise out the carry propagation after the <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Wrap"><span class="id" title="definition">Wrap</span></a></span> step and
         differ it till the additional <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.blake2.c.portable.html#u"><span class="id" title="variable">u</span></a>*5</span> is added (if required).
      
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.FullReduction"><span class="id" title="definition">FullReduction</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Wrap"><span class="id" title="definition">Wrap</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.ReductionAmount"><span class="id" title="definition">ReductionAmount</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#4c780dd263995017be83c27eb863e762"><span class="id" title="notation">×</span></a> 5<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.a0"><span class="id" title="variable">a<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Propagate"><span class="id" title="definition">Propagate</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab75"></a><h2 class="section">Computing the hash.</h2>


<div class="paragraph"> </div>

         The final message has is computed using the algorithm <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.A"><span class="id" title="projection">A</span></a></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a></span>
         <span class="inlinecode"><span class="id" title="var">mod</span></span> <span class="inlinecode"><span class="id" title="var">2<sup>128</sup></span></span>. The elem

<div class="paragraph"> </div>

      
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.ComputeMAC"><span class="id" title="definition">ComputeMAC</span></a> := <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.FullReduction"><span class="id" title="definition">FullReduction</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Add128"><span class="id" title="definition">Add128</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.SArray"><span class="id" title="variable">SArray</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Propagate"><span class="id" title="definition">Propagate</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.MovA"><span class="id" title="definition">MovA</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab76"></a><h1 class="section">Handling input.</h1>


<div class="paragraph"> </div>

      When computing the poly1305 MAC, we need to take each successive
      block of data, convert it into the appropriate coefficient of
      the message polynomial and add it to the accumulator for the
      Horner's method. We have two variants depending on whether the
      block is full or partial.
      
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.ProcessBlock"><span class="id" title="definition">ProcessBlock</span></a> (<span class="id" title="var">AddC</span> : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Block"><span class="id" title="definition">Block</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a>)(<span class="id" title="var">blk</span> : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Block"><span class="id" title="definition">Block</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#AddC"><span class="id" title="variable">AddC</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#blk"><span class="id" title="variable">blk</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.MulR"><span class="id" title="definition">MulR</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.AdjustBits"><span class="id" title="definition">AdjustBits</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.ProcessFullBlock"><span class="id" title="definition">ProcessFullBlock</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Block"><span class="id" title="definition">Block</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a>  := <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.ProcessBlock"><span class="id" title="definition">ProcessBlock</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.AddFullBlock"><span class="id" title="definition">AddFullBlock</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.ProcessLastBlock"><span class="id" title="definition">ProcessLastBlock</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Block"><span class="id" title="definition">Block</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Logic.html#d43e996736952df71ebeeae74d10a287"><span class="id" title="notation">→</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a>  := <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.ProcessBlock"><span class="id" title="definition">ProcessBlock</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Add128"><span class="id" title="definition">Add128</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab77"></a><h1 class="section">The exported functions and iterators.</h1>


<div class="paragraph"> </div>

        We are now ready to define all the relevant functions that a
        poly1305 implementation needs. Recall that we have two
        variants of poly1305 iterator, a partial block handling
        function and a clamping function.

<div class="paragraph"> </div>

     
<div class="paragraph"> </div>

<a name="lab78"></a><h2 class="section">Incremental processing.</h2>


<div class="paragraph"> </div>

        This iterator is used to process complete blocks which forms
        the intermediate blocks of the message. Consider computing the
        message hash of a streaming input. We have with us currently
        few full blocks and more data is expected. We can use this
        iterator to process such data.

<div class="paragraph"> </div>

     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.poly1305Iter"><span class="id" title="definition">poly1305Iter</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#iterator"><span class="id" title="record">iterator</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Block"><span class="id" title="definition">Block</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">verse</span> {| <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">setup</span></a>    <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">LoadA</span></a>  <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">++</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">LoadR</span></a><a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">process</span></a>  <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">ProcessFullBlock</span></a><a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">finalise</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">MovA</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab79"></a><h2 class="section">MAC for complete blocks.</h2>


<div class="paragraph"> </div>

        This iterator updates the accumulator with the message
        hash. The use case of this iterator is the following
        situation: We have already processed some blocks using the
        <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.poly1305Iter"><span class="id" title="definition">poly1305Iter</span></a></span> and we are left with a message that is a
        multiple of the block length.

<div class="paragraph"> </div>

     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.poly1305IterMAC"><span class="id" title="definition">poly1305IterMAC</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{| <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">setup</span></a>    <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">setup</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">poly1305Iter</span></a><a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">process</span></a>  <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">process</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">poly1305Iter</span></a><a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">finalise</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">ComputeMAC</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>

<br/>
</div>

<div class="doc">
<a name="lab80"></a><h2 class="section">Processing partial block.</h2>


<div class="paragraph"> </div>

        This function updates the accumulator with the message hash
        when the message is smaller than the block size but is padded
        appropriately. The use case of this function is to handle the
        last partial block.
     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.poly1305PartialMAC"><span class="id" title="definition">poly1305PartialMAC</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Verse.Verse.Language.Ast.html#setup"><span class="id" title="projection">setup</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.poly1305IterMAC"><span class="id" title="definition">poly1305IterMAC</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.ProcessLastBlock"><span class="id" title="definition">ProcessLastBlock</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.LastBlock"><span class="id" title="variable">LastBlock</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#finalise"><span class="id" title="projection">finalise</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.poly1305IterMAC"><span class="id" title="definition">poly1305IterMAC</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab81"></a><h2 class="section">Clamping <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a></span>.</h2>


<div class="paragraph"> </div>

        The parameter <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a></span> used in Poly1305 has certain 22-bits set to
        zero. Converting an arbitrary 128-bit word to such a form is
        called clamping. The rules of clamping is the following.

<div class="paragraph"> </div>

<ul class="doclist">
<li> Among the least 32-bits the top 4 bits is cleared.

<div class="paragraph"> </div>


</li>
<li> Among the other 3 32-bits, the top 4 and the bottom 2-bits
          are cleared.

</li>
</ul>

<div class="paragraph"> </div>

   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.clamp"><span class="id" title="definition">clamp</span></a> (<span class="id" title="var">blk</span> : <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Block"><span class="id" title="definition">Block</span></a>) : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">verse</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e5f90bd3e877d9e98ec926ce1508c97d"><span class="id" title="notation">::=</span></a> <span class="id" title="var">blk</span><a class="idref" href="Verse.Verse.Language.Pretty.html#6990918f84290fa34850a4b77307cea9"><span class="id" title="notation">[-</span></a> 0 <a class="idref" href="Verse.Verse.Language.Pretty.html#6990918f84290fa34850a4b77307cea9"><span class="id" title="notation">-]</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#dc3ddc621107d5976c8e43171a9d7186"><span class="id" title="notation">::=&amp;</span></a> <a class="idref" href="Verse.Verse.Nibble.html#Ox"><span class="id" title="definition">Ox</span></a> "0f:ff:ff:fc 0f:ff:ff:ff"<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Pretty.html#91540c87ae8fa322a43bd88414257ccb"><span class="id" title="notation">MOVE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#91540c87ae8fa322a43bd88414257ccb"><span class="id" title="notation">TO</span></a> <span class="id" title="var">blk</span><a class="idref" href="Verse.Verse.Language.Pretty.html#91540c87ae8fa322a43bd88414257ccb"><span class="id" title="notation">[-</span></a> 0 <a class="idref" href="Verse.Verse.Language.Pretty.html#91540c87ae8fa322a43bd88414257ccb"><span class="id" title="notation">-]</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e5f90bd3e877d9e98ec926ce1508c97d"><span class="id" title="notation">::=</span></a> <span class="id" title="var">blk</span><a class="idref" href="Verse.Verse.Language.Pretty.html#6990918f84290fa34850a4b77307cea9"><span class="id" title="notation">[-</span></a> 1 <a class="idref" href="Verse.Verse.Language.Pretty.html#6990918f84290fa34850a4b77307cea9"><span class="id" title="notation">-]</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#dc3ddc621107d5976c8e43171a9d7186"><span class="id" title="notation">::=&amp;</span></a> <a class="idref" href="Verse.Verse.Nibble.html#Ox"><span class="id" title="definition">Ox</span></a> "0f:ff:ff:fc 0f:ff:ff:fc"<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Pretty.html#91540c87ae8fa322a43bd88414257ccb"><span class="id" title="notation">MOVE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#91540c87ae8fa322a43bd88414257ccb"><span class="id" title="notation">TO</span></a> <span class="id" title="var">blk</span><a class="idref" href="Verse.Verse.Language.Pretty.html#91540c87ae8fa322a43bd88414257ccb"><span class="id" title="notation">[-</span></a> 1 <a class="idref" href="Verse.Verse.Language.Pretty.html#91540c87ae8fa322a43bd88414257ccb"><span class="id" title="notation">-]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>%<span class="id" title="var">list</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.regClamp"><span class="id" title="definition">regClamp</span></a> : <a class="idref" href="Verse.Verse.Syntax.html#Declaration"><span class="id" title="abbreviation">Declaration</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#b68b81bcad07e24b95d313521ca8d755"><span class="id" title="notation">[</span></a><a class="idref" href="Verse.Verse.Syntax.html#Var"><span class="id" title="definition">Var</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.T0"><span class="id" title="variable">T<sub>0</sub></span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#b68b81bcad07e24b95d313521ca8d755"><span class="id" title="notation">]</span></a>%<span class="id" title="var">vector</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.clampIter"><span class="id" title="definition">clampIter</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#iterator"><span class="id" title="record">iterator</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Block"><span class="id" title="definition">Block</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.progvar"><span class="id" title="variable">progvar</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= {| <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">setup</span></a>    <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">[]%</span></a><a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">list</span></a><a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">process</span></a>  <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">clamp</span></a><a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">finalise</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">[]%</span></a><a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">list</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305"><span class="id" title="section">Poly1305</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">Verse.Arch.C</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.reg"><span class="id" title="definition">reg</span></a> (<span class="id" title="var">regName</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="Verse.Verse.Arch.C.html#cr"><span class="id" title="constructor">cr</span></a> <a class="idref" href="Verse.Verse.Types.Internal.html#uint64_t"><span class="id" title="constructor">uint64_t</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#regName"><span class="id" title="variable">regName</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.polyRegs"><span class="id" title="definition">polyRegs</span></a> := <a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">(-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.reg"><span class="id" title="definition">reg</span></a> "a0"<a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">,</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.reg"><span class="id" title="definition">reg</span></a> "a1"<a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">,</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.reg"><span class="id" title="definition">reg</span></a> "a2"<a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">,</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.reg"><span class="id" title="definition">reg</span></a> "a3"<a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">,</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.reg"><span class="id" title="definition">reg</span></a> "a4"<a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.reg"><span class="id" title="definition">reg</span></a> "r0"<a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">,</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.reg"><span class="id" title="definition">reg</span></a> "r1"<a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">,</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.reg"><span class="id" title="definition">reg</span></a> "r2"<a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">,</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.reg"><span class="id" title="definition">reg</span></a> "r3"<a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.reg"><span class="id" title="definition">reg</span></a> "p1"<a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">,</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.reg"><span class="id" title="definition">reg</span></a> "p2"<a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">,</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.reg"><span class="id" title="definition">reg</span></a> "p3"<a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">,</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.reg"><span class="id" title="definition">reg</span></a> "p4"<a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.reg"><span class="id" title="definition">reg</span></a> "T0"<a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">,</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.reg"><span class="id" title="definition">reg</span></a> "T1"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">-)</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.clampReg"><span class="id" title="definition">clampReg</span></a> := <a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">(-</span></a> <a class="idref" href="Verse.Verse.Arch.C.html#cr"><span class="id" title="constructor">cr</span></a> <a class="idref" href="Verse.Verse.Types.Internal.html#uint64_t"><span class="id" title="constructor">uint64_t</span></a> "temp" <a class="idref" href="Verse.Verse.Syntax.html#35fdc7f0ccdeaec97f45823e6d040885"><span class="id" title="notation">-)</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.prototypeIncremental"><span class="id" title="definition">prototypeIncremental</span></a> (<span class="id" title="var">fname</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) : <a class="idref" href="Verse.Verse.Types.html#Prototype"><span class="id" title="record">Prototype</span></a> <a class="idref" href="Verse.Verse.Types.Internal.html#CType"><span class="id" title="inductive">CType</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">{</span></a><a class="idref" href="Verse.Verse.Arch.C.html#Compile.CompileError"><span class="id" title="inductive">Compile.CompileError</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">}</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Compile.iteratorPrototype</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Block"><span class="id" title="definition">Block</span></a> <span class="id" title="var">fname</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.paramsIncremental"><span class="id" title="definition">paramsIncremental</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.prototypeBlockMac"><span class="id" title="definition">prototypeBlockMac</span></a> (<span class="id" title="var">fname</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) : <a class="idref" href="Verse.Verse.Types.html#Prototype"><span class="id" title="record">Prototype</span></a> <a class="idref" href="Verse.Verse.Types.Internal.html#CType"><span class="id" title="inductive">CType</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">{</span></a><a class="idref" href="Verse.Verse.Arch.C.html#Compile.CompileError"><span class="id" title="inductive">Compile.CompileError</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">}</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Compile.iteratorPrototype</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Block"><span class="id" title="definition">Block</span></a> <span class="id" title="var">fname</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.paramsBlockMac"><span class="id" title="definition">paramsBlockMac</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.prototypePartialMac"><span class="id" title="definition">prototypePartialMac</span></a> (<span class="id" title="var">fname</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) : <a class="idref" href="Verse.Verse.Types.html#Prototype"><span class="id" title="record">Prototype</span></a> <a class="idref" href="Verse.Verse.Types.Internal.html#CType"><span class="id" title="inductive">CType</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">{</span></a><a class="idref" href="Verse.Verse.Arch.C.html#Compile.CompileError"><span class="id" title="inductive">Compile.CompileError</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">}</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Compile.functionPrototype</span> <span class="id" title="var">fname</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.paramsPartialMac"><span class="id" title="definition">paramsPartialMac</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.prototypeClamp"><span class="id" title="definition">prototypeClamp</span></a> (<span class="id" title="var">fname</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) : <a class="idref" href="Verse.Verse.Types.html#Prototype"><span class="id" title="record">Prototype</span></a> <a class="idref" href="Verse.Verse.Types.Internal.html#CType"><span class="id" title="inductive">CType</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">{</span></a><a class="idref" href="Verse.Verse.Arch.C.html#Compile.CompileError"><span class="id" title="inductive">Compile.CompileError</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">}</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Compile.iteratorPrototype</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Block"><span class="id" title="definition">Block</span></a> <span class="id" title="var">fname</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.paramsClamp"><span class="id" title="definition">paramsClamp</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.implementationIncremental"><span class="id" title="definition">implementationIncremental</span></a> (<span class="id" title="var">fname</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) : <a class="idref" href="Verse.Verse.PrettyPrint.html#Doc"><span class="id" title="inductive">Doc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">{</span></a><a class="idref" href="Verse.Verse.Arch.C.html#Compile.CompileError"><span class="id" title="inductive">Compile.CompileError</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">}</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Compile.iterator</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Block"><span class="id" title="definition">Block</span></a> <span class="id" title="var">fname</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.paramsIncremental"><span class="id" title="definition">paramsIncremental</span></a> <a class="idref" href="Verse.Verse.Syntax.html#Empty"><span class="id" title="definition">Empty</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.register"><span class="id" title="definition">register</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">assignRegisters</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.polyRegs"><span class="id" title="definition">polyRegs</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">statements</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.poly1305Iter"><span class="id" title="definition">poly1305Iter</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.implementationBlockMac"><span class="id" title="definition">implementationBlockMac</span></a> (<span class="id" title="var">fname</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) : <a class="idref" href="Verse.Verse.PrettyPrint.html#Doc"><span class="id" title="inductive">Doc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">{</span></a><a class="idref" href="Verse.Verse.Arch.C.html#Compile.CompileError"><span class="id" title="inductive">Compile.CompileError</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">}</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Compile.iterator</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Block"><span class="id" title="definition">Block</span></a> <span class="id" title="var">fname</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.paramsBlockMac"><span class="id" title="definition">paramsBlockMac</span></a> <a class="idref" href="Verse.Verse.Syntax.html#Empty"><span class="id" title="definition">Empty</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.register"><span class="id" title="definition">register</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">assignRegisters</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.polyRegs"><span class="id" title="definition">polyRegs</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">statements</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.poly1305IterMAC"><span class="id" title="definition">poly1305IterMAC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.implementationPartialMac"><span class="id" title="definition">implementationPartialMac</span></a> (<span class="id" title="var">fname</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) : <a class="idref" href="Verse.Verse.PrettyPrint.html#Doc"><span class="id" title="inductive">Doc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">{</span></a><a class="idref" href="Verse.Verse.Arch.C.html#Compile.CompileError"><span class="id" title="inductive">Compile.CompileError</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">}</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Compile.function</span> <span class="id" title="var">fname</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.paramsPartialMac"><span class="id" title="definition">paramsPartialMac</span></a> <a class="idref" href="Verse.Verse.Syntax.html#Empty"><span class="id" title="definition">Empty</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.register"><span class="id" title="definition">register</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">assignRegisters</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.polyRegs"><span class="id" title="definition">polyRegs</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">statements</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.poly1305PartialMAC"><span class="id" title="definition">poly1305PartialMAC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.implementationClamp"><span class="id" title="definition">implementationClamp</span></a> (<span class="id" title="var">fname</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) : <a class="idref" href="Verse.Verse.PrettyPrint.html#Doc"><span class="id" title="inductive">Doc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">{</span></a><a class="idref" href="Verse.Verse.Arch.C.html#Compile.CompileError"><span class="id" title="inductive">Compile.CompileError</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">}</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Compile.iterator</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Block"><span class="id" title="definition">Block</span></a> <span class="id" title="var">fname</span> <a class="idref" href="Verse.Verse.Syntax.html#Empty"><span class="id" title="definition">Empty</span></a> <a class="idref" href="Verse.Verse.Syntax.html#Empty"><span class="id" title="definition">Empty</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.regClamp"><span class="id" title="definition">regClamp</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">assignRegisters</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.clampReg"><span class="id" title="definition">clampReg</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">statements</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.clampIter"><span class="id" title="definition">clampIter</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.incrementalName"><span class="id" title="definition">incrementalName</span></a> (<span class="id" title="var">fname</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#fname"><span class="id" title="variable">fname</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> "_incremental".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.blockMacName"><span class="id" title="definition">blockMacName</span></a>    (<span class="id" title="var">fname</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#fname"><span class="id" title="variable">fname</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> "_blockmac".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.partialMacName"><span class="id" title="definition">partialMacName</span></a>(<span class="id" title="var">fname</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>)    := <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#fname"><span class="id" title="variable">fname</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> "_partialmac".<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.clampName"><span class="id" title="definition">clampName</span></a>       (<span class="id" title="var">fname</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#fname"><span class="id" title="variable">fname</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#6c3bece79abbc48868e7371c2d2fa55c"><span class="id" title="notation">++</span></a> "_clamp".<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.implementation"><span class="id" title="definition">implementation</span></a> (<span class="id" title="var">fname</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) : <a class="idref" href="Verse.Verse.PrettyPrint.html#Doc"><span class="id" title="inductive">Doc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">+</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">{</span></a><a class="idref" href="Verse.Verse.Arch.C.html#Compile.CompileError"><span class="id" title="inductive">Compile.CompileError</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Specif.html#f54393d7670a5aa26d6e138373d42f1c"><span class="id" title="notation">}</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">incr</span> <a class="idref" href="Verse.Verse.Error.html#9de03680d7b45b7f84bb39e0173c68a2"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.implementationIncremental"><span class="id" title="definition">implementationIncremental</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.incrementalName"><span class="id" title="definition">incrementalName</span></a>  <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#fname"><span class="id" title="variable">fname</span></a>) <a class="idref" href="Verse.Verse.Error.html#9de03680d7b45b7f84bb39e0173c68a2"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">blockmac</span> <a class="idref" href="Verse.Verse.Error.html#9de03680d7b45b7f84bb39e0173c68a2"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.implementationBlockMac"><span class="id" title="definition">implementationBlockMac</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.blockMacName"><span class="id" title="definition">blockMacName</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#fname"><span class="id" title="variable">fname</span></a>) <a class="idref" href="Verse.Verse.Error.html#9de03680d7b45b7f84bb39e0173c68a2"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">partialmac</span> <a class="idref" href="Verse.Verse.Error.html#9de03680d7b45b7f84bb39e0173c68a2"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.implementationPartialMac"><span class="id" title="definition">implementationPartialMac</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.partialMacName"><span class="id" title="definition">partialMacName</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#fname"><span class="id" title="variable">fname</span></a>)<a class="idref" href="Verse.Verse.Error.html#9de03680d7b45b7f84bb39e0173c68a2"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">clamp</span> <a class="idref" href="Verse.Verse.Error.html#9de03680d7b45b7f84bb39e0173c68a2"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.implementationClamp"><span class="id" title="definition">implementationClamp</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.clampName"><span class="id" title="definition">clampName</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#fname"><span class="id" title="variable">fname</span></a>)<a class="idref" href="Verse.Verse.Error.html#9de03680d7b45b7f84bb39e0173c68a2"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Error.html#509f3c9de0509312cf78973d75032499"><span class="id" title="notation">{-</span></a> <a class="idref" href="Verse.Verse.PrettyPrint.html#vcat"><span class="id" title="definition">vcat</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <span class="id" title="var">incr</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <span class="id" title="var">blockmac</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <span class="id" title="var">partialmac</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <span class="id" title="var">clamp</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>%<span class="id" title="var">list</span> <a class="idref" href="Verse.Verse.Error.html#509f3c9de0509312cf78973d75032499"><span class="id" title="notation">-}</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="Internal.prototypes"><span class="id" title="definition">prototypes</span></a> <span class="id" title="var">fname</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">incrP</span> <a class="idref" href="Verse.Verse.Error.html#9de03680d7b45b7f84bb39e0173c68a2"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.prototypeIncremental"><span class="id" title="definition">prototypeIncremental</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.incrementalName"><span class="id" title="definition">incrementalName</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#fname"><span class="id" title="variable">fname</span></a>)<a class="idref" href="Verse.Verse.Error.html#9de03680d7b45b7f84bb39e0173c68a2"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">blockmacP</span> <a class="idref" href="Verse.Verse.Error.html#9de03680d7b45b7f84bb39e0173c68a2"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.prototypeBlockMac"><span class="id" title="definition">prototypeBlockMac</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.blockMacName"><span class="id" title="definition">blockMacName</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#fname"><span class="id" title="variable">fname</span></a>)<a class="idref" href="Verse.Verse.Error.html#9de03680d7b45b7f84bb39e0173c68a2"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">partialmacP</span> <a class="idref" href="Verse.Verse.Error.html#9de03680d7b45b7f84bb39e0173c68a2"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.prototypePartialMac"><span class="id" title="definition">prototypePartialMac</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.partialMacName"><span class="id" title="definition">partialMacName</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#fname"><span class="id" title="variable">fname</span></a>)<a class="idref" href="Verse.Verse.Error.html#9de03680d7b45b7f84bb39e0173c68a2"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">clampP</span> <a class="idref" href="Verse.Verse.Error.html#9de03680d7b45b7f84bb39e0173c68a2"><span class="id" title="notation">&lt;-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.prototypeClamp"><span class="id" title="definition">prototypeClamp</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.clampName"><span class="id" title="definition">clampName</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#fname"><span class="id" title="variable">fname</span></a>)<a class="idref" href="Verse.Verse.Error.html#9de03680d7b45b7f84bb39e0173c68a2"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Error.html#509f3c9de0509312cf78973d75032499"><span class="id" title="notation">{-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <span class="id" title="var">incrP</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <span class="id" title="var">blockmacP</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <span class="id" title="var">partialmacP</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <span class="id" title="var">clampP</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>%<span class="id" title="var">list</span> <a class="idref" href="Verse.Verse.Error.html#509f3c9de0509312cf78973d75032499"><span class="id" title="notation">-}</span></a>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal"><span class="id" title="module">Internal</span></a>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Verse.Verse.Extraction.Ocaml.html#"><span class="id" title="library">Verse.Extraction.Ocaml</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Verse.Verse.CryptoLib.Names.html#"><span class="id" title="library">Verse.CryptoLib.Names</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Verse.Verse.CryptoLib.Names.html#"><span class="id" title="library">Verse.CryptoLib.Names</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="implementation_name"><span class="id" title="definition">implementation_name</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.Names.html#Name"><span class="id" title="record">Name</span></a> := {| <a class="idref" href="Verse.Verse.CryptoLib.Names.html#Build_Name"><span class="id" title="constructor">primitive</span></a> <a class="idref" href="Verse.Verse.CryptoLib.Names.html#Build_Name"><span class="id" title="constructor">:=</span></a> "poly1305"<a class="idref" href="Verse.Verse.CryptoLib.Names.html#Build_Name"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.Names.html#Build_Name"><span class="id" title="constructor">arch</span></a>      <a class="idref" href="Verse.Verse.CryptoLib.Names.html#Build_Name"><span class="id" title="constructor">:=</span></a> "c"<a class="idref" href="Verse.Verse.CryptoLib.Names.html#Build_Name"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.Names.html#Build_Name"><span class="id" title="constructor">features</span></a>  <a class="idref" href="Verse.Verse.CryptoLib.Names.html#Build_Name"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.Names.html#Build_Name"><span class="id" title="constructor">[</span></a>"portable"<a class="idref" href="Verse.Verse.CryptoLib.Names.html#Build_Name"><span class="id" title="constructor">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}%<span class="id" title="var">string</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="cname"><span class="id" title="definition">cname</span></a>     := <a class="idref" href="Verse.Verse.CryptoLib.Names.html#cFunName"><span class="id" title="definition">cFunName</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#implementation_name"><span class="id" title="definition">implementation_name</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a name="cfilename"><span class="id" title="definition">cfilename</span></a> := <a class="idref" href="Verse.Verse.CryptoLib.Names.html#libVerseFilePath"><span class="id" title="definition">libVerseFilePath</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#implementation_name"><span class="id" title="definition">implementation_name</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="implementation"><span class="id" title="definition">implementation</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#unit"><span class="id" title="inductive">unit</span></a><br/>
&nbsp;&nbsp;:= <a class="idref" href="Verse.Verse.Extraction.Ocaml.html#writeProgram"><span class="id" title="definition">writeProgram</span></a> (<a class="idref" href="Verse.Verse.Extraction.Ocaml.html#C"><span class="id" title="constructor">C</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#cfilename"><span class="id" title="definition">cfilename</span></a>) (<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#implementation"><span class="id" title="definition">Internal.implementation</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#cname"><span class="id" title="definition">cname</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="prototypes"><span class="id" title="definition">prototypes</span></a><br/>
&nbsp;&nbsp;:= <a class="idref" href="Verse.Verse.Error.html#recover"><span class="id" title="definition">recover</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#prototypes"><span class="id" title="definition">Internal.prototypes</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#cname"><span class="id" title="definition">cname</span></a>).<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Verse.Verse.FFI.Raaz.html#"><span class="id" title="library">Verse.FFI.Raaz</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="raazFFI"><span class="id" title="definition">raazFFI</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#unit"><span class="id" title="inductive">unit</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">module</span> := <a class="idref" href="Verse.Verse.CryptoLib.Names.html#raazModule"><span class="id" title="definition">raazModule</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#implementation_name"><span class="id" title="definition">implementation_name</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.Names.html#write_module"><span class="id" title="definition">write_module</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#module"><span class="id" title="variable">module</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#map"><span class="id" title="definition">List.map</span></a> <a class="idref" href="Verse.Verse.FFI.Raaz.html#ccall"><span class="id" title="definition">ccall</span></a> <a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#prototypes"><span class="id" title="definition">prototypes</span></a>).<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>