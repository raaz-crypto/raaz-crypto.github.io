<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Verse.Verse.CryptoLib.sha2.c.portableAlternate</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Verse.Verse.CryptoLib.sha2.c.portableAlternate</h1>

<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Verse.Verse.html#"><span class="id" title="library">Verse</span></a>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#"><span class="id" title="library">Verse.CryptoLib.sha2</span></a>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">Nat</span>.<br/>
<span class="id" title="keyword">Require</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.Vector.html#"><span class="id" title="library">Vector</span></a>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">VectorNotations</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#"><span class="id" title="library">List</span></a>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">ListNotations</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab92"></a><h1 class="section">SHA2 hashing algorithm.</h1>


<div class="paragraph"> </div>

We can now give a common iterator for both the sha512 and sha256
algorithm. It is implemented as a module parameterised over the
configuration module.

<div class="paragraph"> </div>


</div>
<div class="code">
<span class="id" title="keyword">Module</span> <a name="SHA2"><span class="id" title="module">SHA2</span></a> (<span class="id" title="var">C</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#CONFIG"><span class="id" title="module">CONFIG</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">C</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.Word"><span class="id" title="definition">Word</span></a>  := <a class="idref" href="Verse.Verse.Types.Internal.html#word"><span class="id" title="constructor">word</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C.WordSize"><span class="id" title="axiom">WordSize</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.Hash"><span class="id" title="definition">Hash</span></a>  := <a class="idref" href="Verse.Verse.Types.html#Array"><span class="id" title="definition">Array</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#HASH_SIZE"><span class="id" title="definition">HASH_SIZE</span></a>  <a class="idref" href="Verse.Verse.Types.Internal.html#hostE"><span class="id" title="constructor">hostE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Word"><span class="id" title="definition">Word</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.Block"><span class="id" title="definition">Block</span></a> := <a class="idref" href="Verse.Verse.Types.html#Array"><span class="id" title="definition">Array</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a> <a class="idref" href="Verse.Verse.Types.Internal.html#bigE"><span class="id" title="constructor">bigE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Word"><span class="id" title="definition">Word</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <a name="SHA2.Program"><span class="id" title="section">Program</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="SHA2.Program.v"><span class="id" title="variable">v</span></a> : <a class="idref" href="Verse.Verse.Syntax.html#VariableT"><span class="id" title="definition">VariableT</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Arguments</span> <span class="id" title="var">v</span> [<span class="id" title="var">k</span>] <span class="id" title="var">_</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab93"></a><h2 class="section">Program variables.</h2>


<div class="paragraph"> </div>

        We begin by defining the program variables. Recall that, the
        standard idiom of verse is to declare the parameters, local
        variables, and register variables in that order.

<div class="paragraph"> </div>

     
<div class="paragraph"> </div>

<a name="lab94"></a><h3 class="section">Parameters</h3>


<div class="paragraph"> </div>

        SHA2 hashes are Merkel-Damgrad hash. Hence it needs only the
        hash of the previous blocks to process the current block. Thus
        there is only one parameter for the hash function namely the
        hash of the previous block.

<div class="paragraph"> </div>

     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="SHA2.Program.hash"><span class="id" title="variable">hash</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Hash"><span class="id" title="definition">Hash</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.parameters"><span class="id" title="definition">parameters</span></a> : <a class="idref" href="Verse.Verse.Syntax.html#Declaration"><span class="id" title="abbreviation">Declaration</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#b68b81bcad07e24b95d313521ca8d755"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.Syntax.html#Var"><span class="id" title="definition">Var</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.hash"><span class="id" title="variable">hash</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#b68b81bcad07e24b95d313521ca8d755"><span class="id" title="notation">]</span></a>%<span class="id" title="var">vector</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab95"></a><h3 class="section">Local variables.</h3>


<div class="paragraph"> </div>

        We keep the current block in a set of local variables. The
        advantage of this is that on a register rich machine all of
        them could be allocated in registers and thus could be faster.

<div class="paragraph"> </div>

     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="SHA2.Program.w0"><span class="id" title="variable">w0</span></a> <a name="SHA2.Program.w1"><span class="id" title="variable">w1</span></a> <a name="SHA2.Program.w2"><span class="id" title="variable">w2</span></a> <a name="SHA2.Program.w3"><span class="id" title="variable">w3</span></a> <a name="SHA2.Program.w4"><span class="id" title="variable">w4</span></a> <a name="SHA2.Program.w5"><span class="id" title="variable">w5</span></a> <a name="SHA2.Program.w6"><span class="id" title="variable">w6</span></a> <a name="SHA2.Program.w7"><span class="id" title="variable">w7</span></a> <a name="SHA2.Program.w8"><span class="id" title="variable">w8</span></a> <a name="SHA2.Program.w9"><span class="id" title="variable">w9</span></a> <a name="SHA2.Program.w10"><span class="id" title="variable">w10</span></a> <a name="SHA2.Program.w11"><span class="id" title="variable">w11</span></a> <a name="SHA2.Program.w12"><span class="id" title="variable">w12</span></a> <a name="SHA2.Program.w13"><span class="id" title="variable">w13</span></a> <a name="SHA2.Program.w14"><span class="id" title="variable">w14</span></a> <a name="SHA2.Program.w15"><span class="id" title="variable">w15</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Word"><span class="id" title="definition">Word</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.message_variables"><span class="id" title="definition">message_variables</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">[</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.w0"><span class="id" title="variable">w0</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.w1"><span class="id" title="variable">w1</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.w2"><span class="id" title="variable">w2</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.w3"><span class="id" title="variable">w3</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.w4"><span class="id" title="variable">w4</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.w5"><span class="id" title="variable">w5</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.w6"><span class="id" title="variable">w6</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.w7"><span class="id" title="variable">w7</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.w8"><span class="id" title="variable">w8</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.w9"><span class="id" title="variable">w9</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.w10"><span class="id" title="variable">w10</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.w11"><span class="id" title="variable">w11</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.w12"><span class="id" title="variable">w12</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.w13"><span class="id" title="variable">w13</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.w14"><span class="id" title="variable">w14</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.w15"><span class="id" title="variable">w15</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">]</span></a>%<span class="id" title="var">vector</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.locals"><span class="id" title="definition">locals</span></a> : <a class="idref" href="Verse.Verse.Syntax.html#Declaration"><span class="id" title="abbreviation">Declaration</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.Vector.html#map"><span class="id" title="definition">Vector.map</span></a> <a class="idref" href="Verse.Verse.Syntax.html#Var"><span class="id" title="definition">Var</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.message_variables"><span class="id" title="definition">message_variables</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.W"><span class="id" title="definition">W</span></a> : <a class="idref" href="Verse.Verse.Language.Utils.html#VarIndex"><span class="id" title="definition">VarIndex</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Word"><span class="id" title="definition">Word</span></a> := <a class="idref" href="Verse.Verse.Language.Utils.html#varIndex"><span class="id" title="definition">varIndex</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.message_variables"><span class="id" title="definition">message_variables</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.LOAD_BLOCK"><span class="id" title="definition">LOAD_BLOCK</span></a> (<span class="id" title="var">blk</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Block"><span class="id" title="definition">Block</span></a>) := <a class="idref" href="Verse.Verse.Language.Utils.html#loadCache"><span class="id" title="definition">loadCache</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#blk"><span class="id" title="variable">blk</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.W"><span class="id" title="definition">W</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab96"></a><h2 class="section">The state and temporary variables.</h2>


<div class="paragraph"> </div>

        We choose to put them in registers as there are the variables
        that are frequently used.

<div class="paragraph"> </div>

     
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="SHA2.Program.a"><span class="id" title="variable">a</span></a> <a name="SHA2.Program.b"><span class="id" title="variable">b</span></a> <a name="SHA2.Program.c"><span class="id" title="variable">c</span></a> <a name="SHA2.Program.d"><span class="id" title="variable">d</span></a> <a name="SHA2.Program.e"><span class="id" title="variable">e</span></a> <a name="SHA2.Program.f"><span class="id" title="variable">f</span></a> <a name="SHA2.Program.g"><span class="id" title="variable">g</span></a> <a name="SHA2.Program.h"><span class="id" title="variable">h</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Word"><span class="id" title="definition">Word</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="SHA2.Program.t"><span class="id" title="variable">t</span></a> <a name="SHA2.Program.tp"><span class="id" title="variable">tp</span></a> <a name="SHA2.Program.temp"><span class="id" title="variable">temp</span></a>       : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Word"><span class="id" title="definition">Word</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.state_variables"><span class="id" title="definition">state_variables</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.a"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.b"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.c"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.d"><span class="id" title="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.e"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.f"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.g"><span class="id" title="variable">g</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.h"><span class="id" title="variable">h</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">]</span></a>%<span class="id" title="var">vector</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.registers"><span class="id" title="definition">registers</span></a> : <a class="idref" href="Verse.Verse.Syntax.html#Declaration"><span class="id" title="abbreviation">Declaration</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.Vector.html#map"><span class="id" title="definition">Vector.map</span></a> <a class="idref" href="Verse.Verse.Syntax.html#Var"><span class="id" title="definition">Var</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.Vector.html#append"><span class="id" title="definition">Vector.append</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.state_variables"><span class="id" title="definition">state_variables</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.VectorDef.html#740bb8835345b55ab5881402f3787a31"><span class="id" title="notation">]</span></a>%<span class="id" title="var">vector</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.STATE"><span class="id" title="definition">STATE</span></a> : <a class="idref" href="Verse.Verse.Language.Utils.html#VarIndex"><span class="id" title="definition">VarIndex</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#HASH_SIZE"><span class="id" title="definition">HASH_SIZE</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Word"><span class="id" title="definition">Word</span></a> := <a class="idref" href="Verse.Verse.Language.Utils.html#varIndex"><span class="id" title="definition">varIndex</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.state_variables"><span class="id" title="definition">state_variables</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.LOAD_STATE"><span class="id" title="definition">LOAD_STATE</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> := <a class="idref" href="Verse.Verse.Language.Utils.html#loadCache"><span class="id" title="definition">loadCache</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.hash"><span class="id" title="variable">hash</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.STATE"><span class="id" title="definition">STATE</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab97"></a><h1 class="section">The hash transformation.</h1>


<div class="paragraph"> </div>

      The hashing algorithm transforms a state consisting of
      <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.html#HASH_SIZE"><span class="id" title="definition">HASH_SIZE</span></a></span> many <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAnnotated.html#SHA2.Word"><span class="id" title="definition">Word</span></a></span>s into <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.sha512.c.portable.html#Config.ROUNDS"><span class="id" title="definition">ROUNDS</span></a></span> many rounds. Each round
      uses a message word that is scheduled for that particular
      round. This section builds code towards implementing these.

<div class="paragraph"> </div>

   
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <a name="SHA2.Program.HashTransformation"><span class="id" title="section">HashTransformation</span></a>.<br/>

<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <a name="SHA2.Program.HashTransformation.rBoundPf"><span class="id" title="variable">rBoundPf</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#989c98e7ddd65d5bf37c334ff2076de8"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C.ROUNDS"><span class="id" title="axiom">ROUNDS</span></a>.<br/>

<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.M"><span class="id" title="definition">M</span></a> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Word"><span class="id" title="definition">Word</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">verse</span> (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.W"><span class="id" title="definition">W</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Nat.html#0984ed888197c75c46fdcd2f323d822d"><span class="id" title="notation">mod</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
This defines M(r - j) 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.MM"><span class="id" title="definition">MM</span></a> (<span class="id" title="var">j</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Word"><span class="id" title="definition">Word</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">verse</span> (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.W"><span class="id" title="definition">W</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Nat.html#0984ed888197c75c46fdcd2f323d822d"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> 16 <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <span class="id" title="var">j</span><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Nat.html#0984ed888197c75c46fdcd2f323d822d"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Nat.html#0984ed888197c75c46fdcd2f323d822d"><span class="id" title="notation">mod</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

   The message schedule <span class="inlinecode"><span class="id" title="var">m₁₆</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">m₀</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.Language.Operators.html#OpDenote.VectorAux.m"><span class="id" title="variable">m</span></a>₋<span class="id" title="var">₇</span></span> <span class="inlinecode">+</span> <span class="inlinecode">σ<span class="id" title="var">₀</span></span> <span class="inlinecode">(<a class="idref" href="Verse.Verse.Language.Operators.html#OpDenote.VectorAux.m"><span class="id" title="variable">m</span></a>₋<span class="id" title="var">₁₅</span>)</span> <span class="inlinecode">+</span>  <span class="inlinecode">σ<span class="id" title="var">₁</span>(<a class="idref" href="Verse.Verse.Language.Operators.html#OpDenote.VectorAux.m"><span class="id" title="variable">m</span></a>₋<span class="id" title="var">₂</span>)</span> <span class="inlinecode"></span>,
   requires computing the sigma functions of the form

<div class="paragraph"> </div>

   <span class="inlinecode"></span> <span class="inlinecode">σ(<a class="idref" href="Verse.Verse.Arch.C.html#x"><span class="id" title="variable">x</span></a>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">RotR</span>(<a class="idref" href="Verse.Verse.Arch.C.html#x"><span class="id" title="variable">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r0</span></a>)</span> <span class="inlinecode">⊕</span> <span class="inlinecode"><span class="id" title="var">RotR</span>(<a class="idref" href="Verse.Verse.Arch.C.html#x"><span class="id" title="variable">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r1</span></a>)</span> <span class="inlinecode">⊕</span> <span class="inlinecode"><span class="id" title="var">ShiftR</span>(<a class="idref" href="Verse.Verse.Arch.C.html#x"><span class="id" title="variable">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.Semantics.html#Semantics.Semantics.s"><span class="id" title="variable">s</span></a>)</span>

<div class="paragraph"> </div>

   These functions can be implemented using a single temporary
   variable by updating them using the following telescopic values.

<div class="paragraph"> </div>

   <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">RotR</span>(<a class="idref" href="Verse.Verse.Arch.C.html#x"><span class="id" title="variable">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r2</span></a></span> <span class="inlinecode">-</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r1</span></a>)</span> <span class="inlinecode"></span>

<div class="paragraph"> </div>

   <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">RotR</span>(<a class="idref" href="Verse.Verse.Arch.C.html#x"><span class="id" title="variable">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r2</span></a></span> <span class="inlinecode">-</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r1</span></a>)</span> <span class="inlinecode">⊕</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.Arch.C.html#x"><span class="id" title="variable">x</span></a></span>

<div class="paragraph"> </div>

   <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">RotR</span>(<a class="idref" href="Verse.Verse.Arch.C.html#x"><span class="id" title="variable">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r2</span></a></span> <span class="inlinecode">-</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r0</span></a>)</span> <span class="inlinecode">⊕</span> <span class="inlinecode"><span class="id" title="var">RotR</span>(<a class="idref" href="Verse.Verse.Arch.C.html#x"><span class="id" title="variable">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r1</span></a></span> <span class="inlinecode">-</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r0</span></a>)</span> <span class="inlinecode">⊕</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.Arch.C.html#x"><span class="id" title="variable">x</span></a></span>

<div class="paragraph"> </div>

   <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">RotR</span>(<a class="idref" href="Verse.Verse.Arch.C.html#x"><span class="id" title="variable">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r2"><span class="id" title="variable">r2</span></a>)</span> <span class="inlinecode">⊕</span> <span class="inlinecode"><span class="id" title="var">RotR</span>(<a class="idref" href="Verse.Verse.Arch.C.html#x"><span class="id" title="variable">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r1"><span class="id" title="variable">r1</span></a>)</span> <span class="inlinecode">⊕</span> <span class="inlinecode"><span class="id" title="var">Rot</span>(<a class="idref" href="Verse.Verse.Arch.C.html#x"><span class="id" title="variable">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Verse.Verse.CryptoLib.poly1305.c.portable.html#Internal.Poly1305.r0"><span class="id" title="variable">r0</span></a>)</span>

<div class="paragraph"> </div>

   At each step the temporary variables need to be rotated and then
   xord by x. This message schedule is give by the following code.

<div class="paragraph"> </div>

       
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.SCHEDULE"><span class="id" title="definition">SCHEDULE</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">sigma</span> (<span class="id" title="var">r0</span> <span class="id" title="var">r1</span> <span class="id" title="var">s</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>)(<span class="id" title="var">x</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Word"><span class="id" title="definition">Word</span></a>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e01e4fa8e4b5deaa3d50a75b833817cc"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e01e4fa8e4b5deaa3d50a75b833817cc"><span class="id" title="notation">&gt;&gt;&gt;</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e01e4fa8e4b5deaa3d50a75b833817cc"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#r1"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#r0"><span class="id" title="variable">r0</span></a><a class="idref" href="Verse.Verse.Language.Pretty.html#e01e4fa8e4b5deaa3d50a75b833817cc"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a>    <a class="idref" href="Verse.Verse.Language.Pretty.html#5cb80321c7d7396b2ae1a6d4a6e54c61"><span class="id" title="notation">::=^</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#5c99430fe87eff99074c25ada9701c19"><span class="id" title="notation">::=&gt;&gt;&gt;</span></a>    <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#r0"><span class="id" title="variable">r0</span></a>       <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a>   <a class="idref" href="Verse.Verse.Language.Pretty.html#277babd6c87c6d6fcd2bb26bfa0b5708"><span class="id" title="notation">::=</span></a>  <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#277babd6c87c6d6fcd2bb26bfa0b5708"><span class="id" title="notation">&gt;&gt;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#s"><span class="id" title="variable">s</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#5cb80321c7d7396b2ae1a6d4a6e54c61"><span class="id" title="notation">::=^</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a>            <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.M"><span class="id" title="definition">M</span></a>    <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>%<span class="id" title="var">list</span> <span class="id" title="keyword">in</span><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">sigma0</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#sigma"><span class="id" title="variable">sigma</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C.r00"><span class="id" title="axiom">r00</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C.r01"><span class="id" title="axiom">r01</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C.s0"><span class="id" title="axiom">s0</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.MM"><span class="id" title="definition">MM</span></a> 15) <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">sigma1</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#sigma"><span class="id" title="variable">sigma</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C.r10"><span class="id" title="axiom">r10</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C.r11"><span class="id" title="axiom">r11</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C.s1"><span class="id" title="axiom">s1</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.MM"><span class="id" title="definition">MM</span></a> 2) <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.M"><span class="id" title="definition">M</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.MM"><span class="id" title="definition">MM</span></a> 7 <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#sigma0"><span class="id" title="variable">sigma0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#sigma1"><span class="id" title="variable">sigma1</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab98"></a><h2 class="section">Individual rounds.</h2>


<div class="paragraph"> </div>

      The state of the hash function is kept track of in the set of
      variables a-h, and in the rth round the update is given by

<div class="paragraph"> </div>

       
<div class="paragraph"> </div>


<div class="paragraph"> </div>

<pre>a' = t1 + t2

b' = a

c' = b

d' = c

e' = d + t1

f' = e

g' = f

h' = g

</pre>

<div class="paragraph"> </div>

where

<div class="paragraph"> </div>

<pre>

t1 = h + k + m + σ₁(e) + CH e f g

t2 = σ₀(a) + MAJ a b c

</pre>

<div class="paragraph"> </div>

       
<div class="paragraph"> </div>

 So in each round we compute the following

<div class="paragraph"> </div>

<pre>

temp = h + k + m + σ₁(e) + CH(e,f,g)

d += temp;

h = temp + σ₀(a) + MAJ(a,b,c); </pre>

<div class="paragraph"> </div>

       
</div>
<div class="code">

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.ST"><span class="id" title="definition">ST</span></a> (<span class="id" title="var">i</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Word"><span class="id" title="definition">Word</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">verse</span>(<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">negr</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#HASH_SIZE"><span class="id" title="definition">HASH_SIZE</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Nat.html#0984ed888197c75c46fdcd2f323d822d"><span class="id" title="notation">mod</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#HASH_SIZE"><span class="id" title="definition">HASH_SIZE</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">)</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">idx</span>  := <span class="id" title="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#negr"><span class="id" title="variable">negr</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.STATE"><span class="id" title="definition">STATE</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#idx"><span class="id" title="variable">idx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Nat.html#0984ed888197c75c46fdcd2f323d822d"><span class="id" title="notation">mod</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#HASH_SIZE"><span class="id" title="definition">HASH_SIZE</span></a>) <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.K"><span class="id" title="definition">K</span></a> : <a class="idref" href="Verse.Verse.Types.html#constant"><span class="id" title="definition">constant</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Word"><span class="id" title="definition">Word</span></a> :=  <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Vectors.Vector.html#nth_order"><span class="id" title="definition">Vector.nth_order</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C.KVec"><span class="id" title="axiom">KVec</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.rBoundPf"><span class="id" title="variable">rBoundPf</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.STEP"><span class="id" title="definition">STEP</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">A</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.ST"><span class="id" title="definition">ST</span></a> 0 <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">B</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.ST"><span class="id" title="definition">ST</span></a> 1 <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">C</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.ST"><span class="id" title="definition">ST</span></a> 2 <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">D</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.ST"><span class="id" title="definition">ST</span></a> 3 <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">E</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.ST"><span class="id" title="definition">ST</span></a> 4 <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">F</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.ST"><span class="id" title="definition">ST</span></a> 5 <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">G</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.ST"><span class="id" title="definition">ST</span></a> 6 <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.ST"><span class="id" title="definition">ST</span></a> 7 <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Sigma</span> <span class="id" title="var">r0</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e01e4fa8e4b5deaa3d50a75b833817cc"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e01e4fa8e4b5deaa3d50a75b833817cc"><span class="id" title="notation">&gt;&gt;&gt;</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#e01e4fa8e4b5deaa3d50a75b833817cc"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#r2"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#r1"><span class="id" title="variable">r1</span></a><a class="idref" href="Verse.Verse.Language.Pretty.html#e01e4fa8e4b5deaa3d50a75b833817cc"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a>  <a class="idref" href="Verse.Verse.Language.Pretty.html#5cb80321c7d7396b2ae1a6d4a6e54c61"><span class="id" title="notation">::=^</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#5c99430fe87eff99074c25ada9701c19"><span class="id" title="notation">::=&gt;&gt;&gt;</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#5c99430fe87eff99074c25ada9701c19"><span class="id" title="notation">(</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#r1"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#r0"><span class="id" title="variable">r0</span></a><a class="idref" href="Verse.Verse.Language.Pretty.html#5c99430fe87eff99074c25ada9701c19"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a>    <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#5cb80321c7d7396b2ae1a6d4a6e54c61"><span class="id" title="notation">::=^</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#5c99430fe87eff99074c25ada9701c19"><span class="id" title="notation">::=&gt;&gt;&gt;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#r0"><span class="id" title="variable">r0</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a>%<span class="id" title="var">list</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Sigma0</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#Sigma"><span class="id" title="variable">Sigma</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C.R00"><span class="id" title="axiom">R00</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C.R01"><span class="id" title="axiom">R01</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C.R02"><span class="id" title="axiom">R02</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#A"><span class="id" title="variable">A</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Sigma1</span> := <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#Sigma"><span class="id" title="variable">Sigma</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C.R10"><span class="id" title="axiom">R10</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C.R11"><span class="id" title="axiom">R11</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C.R12"><span class="id" title="axiom">R12</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#E"><span class="id" title="variable">E</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">CH</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#49fcb6331f9408e6cc2a46935ebde8ca"><span class="id" title="notation">::=~</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#E"><span class="id" title="variable">E</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#dc3ddc621107d5976c8e43171a9d7186"><span class="id" title="notation">::=&amp;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#G"><span class="id" title="variable">G</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#3d9d72ad686ce03b433890d080b1de31"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#E"><span class="id" title="variable">E</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#3d9d72ad686ce03b433890d080b1de31"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#F"><span class="id" title="variable">F</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#5cb80321c7d7396b2ae1a6d4a6e54c61"><span class="id" title="notation">::=^</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">MAJ</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a>  <a class="idref" href="Verse.Verse.Language.Pretty.html#999781d535237d922f449c9fd06ec371"><span class="id" title="notation">::=</span></a>  <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#999781d535237d922f449c9fd06ec371"><span class="id" title="notation">|</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C"><span class="id" title="variable">C</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a>  <a class="idref" href="Verse.Verse.Language.Pretty.html#dc3ddc621107d5976c8e43171a9d7186"><span class="id" title="notation">::=&amp;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#A"><span class="id" title="variable">A</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#3d9d72ad686ce03b433890d080b1de31"><span class="id" title="notation">::=</span></a>  <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#B"><span class="id" title="variable">B</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#3d9d72ad686ce03b433890d080b1de31"><span class="id" title="notation">&amp;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C"><span class="id" title="variable">C</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a>  <a class="idref" href="Verse.Verse.Language.Pretty.html#b56946c920ec4d6ffcf5c1ff7ca19d58"><span class="id" title="notation">::=|</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.tp"><span class="id" title="variable">tp</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#a23f2aca9935b18f2f807af2e73f752e"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#H"><span class="id" title="variable">H</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#a23f2aca9935b18f2f807af2e73f752e"><span class="id" title="notation">+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.K"><span class="id" title="definition">K</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.M"><span class="id" title="definition">M</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#f83abbde7679bdbfec6afddd39d41e15"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#CH"><span class="id" title="variable">CH</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a>  <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#Sigma1"><span class="id" title="variable">Sigma1</span></a>        <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#D"><span class="id" title="variable">D</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#Sigma0"><span class="id" title="variable">Sigma0</span></a>               <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#MAJ"><span class="id" title="variable">MAJ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#H"><span class="id" title="variable">H</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#a23f2aca9935b18f2f807af2e73f752e"><span class="id" title="notation">::=</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.temp"><span class="id" title="variable">temp</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#a23f2aca9935b18f2f807af2e73f752e"><span class="id" title="notation">+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.t"><span class="id" title="variable">t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a>. 
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.UPDATE_ITH"><span class="id" title="definition">UPDATE_ITH</span></a> (<span class="id" title="var">i</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) (<span class="id" title="var">pf</span> : <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#i"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#989c98e7ddd65d5bf37c334ff2076de8"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#HASH_SIZE"><span class="id" title="definition">HASH_SIZE</span></a>) : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">verse</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">[</span></a><a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.STATE"><span class="id" title="definition">STATE</span></a> <span class="id" title="var">i</span> <span class="id" title="var">_</span> <a class="idref" href="Verse.Verse.Language.Pretty.html#18058bc06ec017c7cdd67785aa877dc6"><span class="id" title="notation">::=+</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.hash"><span class="id" title="variable">hash</span></a> <a class="idref" href="Verse.Verse.Language.Pretty.html#6990918f84290fa34850a4b77307cea9"><span class="id" title="notation">[-</span></a> <span class="id" title="var">i</span> <a class="idref" href="Verse.Verse.Language.Pretty.html#6990918f84290fa34850a4b77307cea9"><span class="id" title="notation">-]</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Lists.List.html#64ee52ab9627fca8d637e2f1207a2990"><span class="id" title="notation">]</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Defined</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.UPDATE"><span class="id" title="definition">UPDATE</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <a class="idref" href="Verse.Verse.Language.Utils.html#foreach"><span class="id" title="definition">foreach</span></a> (<a class="idref" href="Verse.Verse.Language.Utils.html#indices"><span class="id" title="definition">indices</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.hash"><span class="id" title="variable">hash</span></a>) <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.UPDATE_ITH"><span class="id" title="definition">UPDATE_ITH</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.Language.Utils.html#moveBackCache"><span class="id" title="definition">moveBackCache</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.hash"><span class="id" title="variable">hash</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.STATE"><span class="id" title="definition">STATE</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.Round"><span class="id" title="definition">Round</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Nat.html#leb"><span class="id" title="definition">leb</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation.r"><span class="id" title="variable">r</span></a> (<a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#C.ROUNDS"><span class="id" title="axiom">ROUNDS</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.html#BLOCK_SIZE"><span class="id" title="definition">BLOCK_SIZE</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Peano.html#9482aae3d3b06e249765c1225dbb8cbb"><span class="id" title="notation">-</span></a> 1) <span class="id" title="keyword">then</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.STEP"><span class="id" title="definition">STEP</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.6.1/stdlib/Coq.Init.Datatypes.html#5d35a99a6abff1d64bf70538feb70e36"><span class="id" title="notation">++</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.SCHEDULE"><span class="id" title="definition">SCHEDULE</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.STEP"><span class="id" title="definition">STEP</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">End</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.HashTransformation"><span class="id" title="section">HashTransformation</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.ALL_ROUNDS"><span class="id" title="definition">ALL_ROUNDS</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#code"><span class="id" title="definition">code</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> := <a class="idref" href="Verse.Verse.Language.Utils.html#iterate"><span class="id" title="definition">iterate</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Round"><span class="id" title="definition">Round</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a name="SHA2.sha2"><span class="id" title="definition">sha2</span></a> : <a class="idref" href="Verse.Verse.Language.Ast.html#iterator"><span class="id" title="record">iterator</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Block"><span class="id" title="definition">Block</span></a> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program.v"><span class="id" title="variable">v</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{|<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">setup</span></a>   <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">LOAD_STATE</span></a><a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">process</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">:=</span></a> <span class="id" title="keyword">fun</span> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">block</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">⇒</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">(</span></a><a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">LOAD_BLOCK</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">block</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">++</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">ALL_ROUNDS</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">++</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">UPDATE</span></a><a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">);</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">finalise</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">:=</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">[</span></a> <a class="idref" href="Verse.Verse.Language.Ast.html#Build_iterator"><span class="id" title="constructor">]</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2.Program"><span class="id" title="section">Program</span></a>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Verse.Verse.CryptoLib.sha2.c.portableAlternate.html#SHA2"><span class="id" title="module">SHA2</span></a>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>